!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.LivechatVisitorSDK={})}(this,function(e){"use strict";var t,n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(e){return"@@redux-saga/"+e},b=a("TASK"),o=a("HELPER"),_=a("MATCH"),w=a("CANCEL_PROMISE"),k=a("SAGA_ACTION"),q=a("SELF_CANCELLATION"),i=(t=!0,function(){return t}),$=function(){},l=function(e){return e};function I(e,t,r){if(!t(e))throw Y("error","uncaught at check",r),Error(r)}var s=Object.prototype.hasOwnProperty;function c(e,t){return B.notUndef(e)&&s.call(e,t)}var B={undef:function(e){return null==e},notUndef:function(e){return null!=e},func:function(e){return"function"==typeof e},number:function(e){return"number"==typeof e},string:function(e){return"string"==typeof e},array:Array.isArray,object:function(e){return e&&!B.array(e)&&"object"===(void 0===e?"undefined":r(e))},promise:function(e){return e&&B.func(e.then)},iterator:function(e){return e&&B.func(e.next)&&B.func(e.throw)},iterable:function(e){return e&&B.func(Symbol)?B.func(e[Symbol.iterator]):B.array(e)},task:function(e){return e&&e[b]},observable:function(e){return e&&B.func(e.subscribe)},buffer:function(e){return e&&B.func(e.isEmpty)&&B.func(e.take)&&B.func(e.put)},pattern:function(e){return e&&(B.string(e)||"symbol"===(void 0===e?"undefined":r(e))||B.func(e)||B.array(e))},channel:function(e){return e&&B.func(e.take)&&B.func(e.close)},helper:function(e){return e&&e[o]},stringableFunc:function(e){return B.func(e)&&c(e,"toString")}},V={assign:function(e,t){for(var r in t)c(t,r)&&(e[r]=t[r])}};function z(e,t){var r=e.indexOf(t);r<0||e.splice(r,1)}var H={from:function(e){var t=Array(e.length);for(var r in e)c(e,r)&&(t[r]=e[r]);return t}};function re(){var r=n({},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),e=new Promise(function(e,t){r.resolve=e,r.reject=t});return r.promise=e,r}function u(t){var r=arguments.length<=1||void 0===arguments[1]||arguments[1],n=void 0,e=new Promise(function(e){n=setTimeout(function(){return e(r)},t)});return e[w]=function(){return clearTimeout(n)},e}var W=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return function(){return++e}}(),p=function(e){throw e},f=function(e){return{value:e,done:!0}};function K(e){var t={name:2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",next:e,throw:1<arguments.length&&void 0!==arguments[1]?arguments[1]:p,return:f};return arguments[3]&&(t[o]=!0),"undefined"!=typeof Symbol&&(t[Symbol.iterator]=function(){return t}),t}function Y(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";"undefined"==typeof window?console.log("redux-saga "+e+": "+t+"\n"+(r&&r.stack||r)):console[e](t,r)}function Z(e,t){return function(){return e.apply(void 0,arguments)}}var J=function(e,t){return e+" has been deprecated in favor of "+t+", please update your code"},d=function(e){return Error("\n  redux-saga: Error checking hooks detected an inconsistent state. This is likely a bug\n  in redux-saga code and not yours. Thanks for reporting this in the project's github repo.\n  Error: "+e+"\n")},Q=function(e,t){return(e?e+".":"")+"setContext(props): argument "+t+" is not a plain object"},m=function(t){return function(e){return t(Object.defineProperty(e,k,{value:!0}))}},h={done:!0,value:void 0},g={};var v={isEmpty:i,put:$,take:$};function y(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:10,n=arguments[1],a=Array(r),o=0,i=0,s=0,c=function(e){a[i]=e,i=(i+1)%r,o++},t=function(){if(0!=o){var e=a[s];return a[s]=null,o--,s=(s+1)%r,e}},u=function(){for(var e=[];o;)e.push(t());return e};return{isEmpty:function(){return 0==o},put:function(e){if(o<r)c(e);else{var t=void 0;switch(n){case 1:throw Error("Channel's Buffer overflow!");case 3:a[i]=e,s=i=(i+1)%r;break;case 4:t=2*r,a=u(),i=o=a.length,s=0,r=a.length=t,c(e)}}},take:t,flush:u}}var X={none:function(){return v},fixed:function(e){return y(e,1)},dropping:function(e){return y(e,2)},sliding:function(e){return y(e,3)},expanding:function(e){return y(e,4)}},x=[],T=0;function E(e){try{te(),e()}finally{S()}}function ee(e){x.push(e),T||(te(),ne())}function te(){T++}function S(){T--}function ne(){S();for(var e=void 0;!T&&void 0!==(e=x.shift());)E(e)}var ae=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},P="@@redux-saga/CHANNEL_END",C={type:P},oe=function(e){return e&&e.type===P};var A="invalid buffer passed to channel factory function",O="Saga was provided with an undefined action";function ie(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:X.none(),r=arguments[2];2<arguments.length&&I(r,B.func,"Invalid match function passed to eventChannel");var n=function(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:X.fixed(),a=!1,o=[];function i(){if(a&&o.length)throw d("Cannot have a closed channel with pending takers");if(o.length&&!n.isEmpty())throw d("Cannot have pending takers with non empty buffer")}return I(n,B.buffer,A),{take:function(e){i(),I(e,B.func,"channel.take's callback must be a function"),a&&n.isEmpty()?e(C):n.isEmpty()?(o.push(e),e.cancel=function(){return z(o,e)}):e(n.take())},put:function(e){if(i(),I(e,B.notUndef,O),!a){if(!o.length)return n.put(e);for(var t=0;t<o.length;t++){var r=o[t];if(!r[_]||r[_](e))return o.splice(t,1),r(e)}}},flush:function(e){i(),I(e,B.func,"channel.flush' callback must be a function"),a&&n.isEmpty()?e(C):e(n.flush())},close:function(){if(i(),!a&&(a=!0,o.length)){var e=o;o=[];for(var t=0,r=e.length;t<r;t++)e[t](C)}},get __takers__(){return o},get __closed__(){return a}}}(t),a=function(){n.__closed__||(o&&o(),n.close())},o=e(function(e){oe(e)?a():r&&!r(e)||n.put(e)});if(n.__closed__&&o(),!B.func(o))throw Error("in eventChannel: subscribe should return a function to unsubscribe");return{take:n.take,flush:n.flush,close:a}}function N(e,t){for(var r=arguments.length,n=Array(2<r?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];var o,i={done:!1,value:de(e)},s=void 0,c=function(e){return s=e};return function(n,e){var a=void 0,o=e;function t(e,t){if(o===g)return h;if(t)throw o=g,t;a&&a(e);var r=n[o]();return a=r[2],(o=r[0])===g?h:r[1]}return K(t,function(e){return t(null,e)},2<arguments.length&&void 0!==arguments[2]?arguments[2]:"iterator",!0)}({q1:function(){return["q2",i,c]},q2:function(){return s===C?[g]:["q1",(e=s,{done:!1,value:xe.apply(void 0,[t].concat(n,[e]))})];var e}},"q1","takeEvery("+(B.channel(o=e)?"channel":Array.isArray(o)?o.map(function(e){return e+""})+"":o+"")+", "+t.name+")")}var R=a("IO"),j="TAKE",L="PUT",M="ALL",D="RACE",U="CALL",G="FORK",F="JOIN",se="CANCEL",ce="SELECT",ue="ACTION_CHANNEL",pe="GET_CONTEXT",le="\n(HINT: if you are getting this errors in tests, consider using createMockTask from redux-saga/utils)",fe=function(e,t){var r;return(r={})[R]=!0,r[e]=t,r};function de(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"*";if(arguments.length&&I(arguments[0],B.notUndef,"take(patternOrChannel): patternOrChannel is undefined"),B.pattern(e))return fe(j,{pattern:e});if(B.channel(e))return fe(j,{channel:e});throw Error("take(patternOrChannel): argument "+e+" is not valid channel or a valid pattern")}function he(e,t){return 1<arguments.length?(I(e,B.notUndef,"put(channel, action): argument channel is undefined"),I(e,B.channel,"put(channel, action): argument "+e+" is not a valid channel"),I(t,B.notUndef,"put(channel, action): argument action is undefined")):(I(e,B.notUndef,"put(action): argument action is undefined"),t=e,e=null),fe(L,{channel:e,action:t})}function me(e){return fe(M,e)}function ge(e){return fe(D,e)}function ve(e,t,r){I(t,B.notUndef,e+": argument fn is undefined");var n=null;if(B.array(t)){n=t[0],t=t[1]}else if(t.fn){n=t.context,t=t.fn}return n&&B.string(t)&&B.func(n[t])&&(t=n[t]),I(t,B.func,e+": argument "+t+" is not a function"),{context:n,fn:t,args:r}}function ye(e){for(var t=arguments.length,r=Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return fe(U,ve("call",e,r))}function xe(e){for(var t=arguments.length,r=Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return fe(G,ve("fork",e,r))}function be(e){for(var t=arguments.length,r=Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var a=xe.apply(void 0,[e].concat(r));return a[G].detached=!0,a}function _e(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(1<t.length)return me(t.map(function(e){return _e(e)}));var n=t[0];return I(n,B.notUndef,"join(task): argument task is undefined"),I(n,B.task,"join(task): argument "+n+" is not a valid Task object "+le),fe(F,n)}function we(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(1<t.length)return me(t.map(function(e){return we(e)}));var n=t[0];return 1===t.length&&(I(n,B.notUndef,"cancel(task): argument task is undefined"),I(n,B.task,"cancel(task): argument "+n+" is not a valid Task object "+le)),fe(se,n||q)}function ke(e){for(var t=arguments.length,r=Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return 0===arguments.length?e=l:(I(e,B.notUndef,"select(selector,[...]): argument selector is undefined"),I(e,B.func,"select(selector,[...]): argument "+e+" is not a function")),fe(ce,{selector:e,args:r})}function Ie(e,t){return I(e,B.notUndef,"actionChannel(pattern,...): argument pattern is undefined"),1<arguments.length&&(I(t,B.notUndef,"actionChannel(pattern, buffer): argument buffer is undefined"),I(t,B.buffer,"actionChannel(pattern, buffer): argument "+t+" is not a valid buffer")),fe(ue,{pattern:e,buffer:t})}function Te(e){return I(e,B.string,"getContext(prop): argument "+e+" is not a string"),fe(pe,e)}function Ee(e,t){for(var r=arguments.length,n=Array(2<r?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];return xe.apply(void 0,[N,e,t].concat(n))}de.maybe=function(){var e=de.apply(void 0,arguments);return e[j].maybe=!0,e},he.sync=Z(he.resolve=function(){var e=he.apply(void 0,arguments);return e[L].resolve=!0,e},J("put.sync","put.resolve"));var Se=function(t){return function(e){return e&&e[R]&&e[t]}},Pe={take:Se(j),put:Se(L),all:Se(M),race:Se(D),call:Se(U),cps:Se("CPS"),fork:Se(G),join:Se(F),cancel:Se(se),select:Se(ce),actionChannel:Se(ue),cancelled:Se("CANCELLED"),flush:Se("FLUSH"),getContext:Se(pe),setContext:Se("SET_CONTEXT")},Ce=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var Oe="proc first argument (Saga function result) must be an iterator",Ne={toString:function(){return"@@redux-saga/CHANNEL_END"}},Re={toString:function(){return"@@redux-saga/TASK_CANCEL"}},je={wildcard:function(){return i},default:function(t){return"symbol"===(void 0===t?"undefined":Ae(t))?function(e){return e.type===t}:function(e){return e.type===t+""}},array:function(e){return function(t){return e.some(function(e){return Le(e)(t)})}},predicate:function(t){return function(e){return t(e)}}};function Le(e){return("*"===e?je.wildcard:B.array(e)?je.array:B.stringableFunc(e)?je.default:B.func(e)?je.predicate:je.default)(e)}var Me,De=function(e){return{fn:e}};function Ue(n){var T=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){return $},E=2<arguments.length&&void 0!==arguments[2]?arguments[2]:$,S=3<arguments.length&&void 0!==arguments[3]?arguments[3]:$,e=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{},s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:{},a=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0,P=7<arguments.length&&void 0!==arguments[7]?arguments[7]:"anonymous",t=arguments[8];I(n,B.iterator,Oe);var r,o,i="[...effects]",C=Z(F,J(i,"all("+i+")")),A=s.sagaMonitor,c=s.onError,O=s.logger||Y,N=(r=T,o=ie(function(t){return r(function(e){e[k]?t(e):ee(function(){return t(e)})})}),ae({},o,{take:function(e,t){1<arguments.length&&(I(t,B.func,"channel.take's matcher argument must be a function"),e[_]=t),o.take(e)}})),R=Object.create(e);y.cancel=$;var u,p,l,f,d,h,m,j=(u=a,p=P,f=t,(h={})[b]=!((l=n)._deferredEnd=null),h.id=u,h.name=p,(m={})[d="done"]=m[d]||{},m[d].get=function(){if(l._deferredEnd)return l._deferredEnd.promise;var e=re();return l._deferredEnd=e,l._isRunning||(l._error?e.reject(l._error):e.resolve(l._result)),e.promise},h.cont=f,h.joiners=[],h.cancel=v,h.isRunning=function(){return l._isRunning},h.isCancelled=function(){return l._isCancelled},h.isAborted=function(){return l._isAborted},h.result=function(){return l._result},h.error=function(){return l._error},h.setContext=function(e){I(e,B.object,Q("task",e)),V.assign(R,e)},function(e,t){for(var r in t){var n=t[r];n.configurable=n.enumerable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r,n)}}(h,m),h),L={name:P,cancel:function(){L.isRunning&&!L.isCancelled&&(L.isCancelled=!0,y(Re))},isRunning:!0},g=function(e,n,a){var o=[],i=void 0,s=!1;function c(e){r(),a(e,!0)}function t(r){o.push(r),r.cont=function(e,t){s||(z(o,r),r.cont=$,t?c(e):(r===n&&(i=e),o.length||(s=!0,a(i))))}}function r(){s||(s=!0,o.forEach(function(e){e.cont=$,e.cancel()}),o=[])}return t(n),{addTask:t,cancelAll:r,abort:c,getTasks:function(){return o},taskNames:function(){return o.map(function(e){return e.name})}}}(0,L,x);function v(){n._isRunning&&!n._isCancelled&&(n._isCancelled=!0,g.cancelAll(),x(Re))}return t&&(t.cancel=v),n._isRunning=!0,y(),j;function y(e,t){if(!L.isRunning)throw Error("Trying to resume an already finished generator");try{var r=void 0;(r=t?n.throw(e):e===Re?(L.isCancelled=!0,y.cancel(),B.func(n.return)?n.return(Re):{done:!0,value:Re}):e===Ne?B.func(n.return)?n.return():{done:!0}:n.next(e)).done?(L.isMainRunning=!1,L.cont&&L.cont(r.value)):M(r.value,a,"",y)}catch(e){L.isCancelled&&O("error","uncaught at "+P,e.message),L.isMainRunning=!1,L.cont(e,!0)}}function x(t,r){n._isRunning=!1,N.close(),r?(t instanceof Error&&(t.sagaStack="at "+P+" \n "+(t.sagaStack||t.stack)),j.cont||(O("error","uncaught",t.sagaStack||t.stack),t instanceof Error&&c&&c(t)),n._error=t,n._isAborted=!0,n._deferredEnd&&n._deferredEnd.reject(t)):(n._result=t,n._deferredEnd&&n._deferredEnd.resolve(t)),j.cont&&j.cont(t,r),j.joiners.forEach(function(e){return e.cb(t,r)}),j.joiners=null}function M(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",n=arguments[3],a=W();A&&A.effectTriggered({effectId:a,parentEffectId:t,label:r,effect:e});var o=void 0;function i(e,t){o||(o=!0,n.cancel=$,A&&(t?A.effectRejected(a,e):A.effectResolved(a,e)),n(e,t))}i.cancel=$,n.cancel=function(){if(!o){o=!0;try{i.cancel()}catch(e){O("error","uncaught at "+P,e.message)}i.cancel=$,A&&A.effectCancelled(a)}};var s,c,u,p,l,f,d,h,m,g,v,y,x,b,_,w,k,I=void 0;return B.promise(e)?D(e,i):B.helper(e)?G(De(e),a,i):B.iterator(e)?U(e,a,P,i):B.array(e)?C(e,a,i):(I=Pe.take(e))?function(e,t){var r=e.channel,n=e.pattern,a=e.maybe;r=r||N;var o=function(e){return e instanceof Error?t(e,!0):oe(e)&&!a?t(Ne):t(e)};try{r.take(o,Le(n))}catch(e){return t(e,!0)}t.cancel=o.cancel}(I,i):(I=Pe.put(e))?(b=i,_=(x=I).channel,w=x.action,k=x.resolve,void ee(function(){var e=void 0;try{e=(_?_.put:E)(w)}catch(e){if(_||k)return b(e,!0);O("error","uncaught at "+P,e.stack||e.message||e)}if(!k||!B.promise(e))return b(e);D(e,b)})):(I=Pe.all(e))?F(I,a,i):(I=Pe.race(e))?(h=a,m=i,g=void 0,y={},(v=Object.keys(d=I)).forEach(function(n){var e=function(e,t){if(!g)if(t)m.cancel(),m(e,!0);else if(!oe(e)&&e!==Ne&&e!==Re){var r;m.cancel(),g=!0,m(((r={})[n]=e,r))}};e.cancel=$,y[n]=e}),m.cancel=function(){g||(g=!0,v.forEach(function(e){return y[e].cancel()}))},void v.forEach(function(e){g||M(d[e],h,e,y[e])})):(I=Pe.call(e))?function(e,t,r){var n=e.context,a=e.fn,o=e.args,i=void 0;try{i=a.apply(n,o)}catch(e){return r(e,!0)}return B.promise(i)?D(i,r):B.iterator(i)?U(i,t,a.name,r):r(i)}(I,a,i):(I=Pe.cps(e))?function(e,r){var t=e.context,n=e.fn,a=e.args;try{var o=function(e,t){return B.undef(e)?r(t):r(e,!0)};n.apply(t,a.concat(o)),o.cancel&&(r.cancel=function(){return o.cancel()})}catch(e){return r(e,!0)}}(I,i):(I=Pe.fork(e))?G(I,a,i):(I=Pe.join(e))?function(e,t){if(e.isRunning()){var r={task:j,cb:t};t.cancel=function(){return z(e.joiners,r)},e.joiners.push(r)}else e.isAborted()?t(e.error(),!0):t(e.result())}(I,i):(I=Pe.cancel(e))?function(e,t){e===q&&(e=j);e.isRunning()&&e.cancel();t()}(I,i):(I=Pe.select(e))?function(e,t){var r=e.selector,n=e.args;try{var a=r.apply(void 0,[S()].concat(n));t(a)}catch(e){t(e,!0)}}(I,i):(I=Pe.actionChannel(e))?(u=i,l=(c=I).buffer,(f=Le(p=c.pattern)).pattern=p,void u(ie(T,l||X.fixed(),f))):(I=Pe.flush(e))?void I.flush(i):(I=Pe.cancelled(e))?void i(!!L.isCancelled):(I=Pe.getContext(e))?void i(R[I]):(I=Pe.setContext(e))?(s=i,V.assign(R,I),void s()):i(e)}function D(e,t){var r=e[w];B.func(r)?t.cancel=r:B.func(e.abort)&&(t.cancel=function(){return e.abort()}),e.then(t,function(e){return t(e,!0)})}function U(e,t,r,n){Ue(e,T,E,S,R,s,t,r,n)}function G(e,t,r){var n=e.fn,a=e.detached,o=function(e){var t=e.context,r=e.fn,n=e.args;if(B.iterator(r))return r;var a,o,i=void 0,s=void 0;try{i=r.apply(t,n)}catch(e){s=e}return B.iterator(i)?i:K(s?function(){throw s}:(a=void 0,o={done:!1,value:i},function(e){return a?{done:!0,value:e}:(a=!0,o)}))}({context:e.context,fn:n,args:e.args});try{te();var i=Ue(o,T,E,S,R,s,t,n.name,a?null:$);a?r(i):o._isRunning?(g.addTask(i),r(i)):o._error?g.abort(o._error):r(i)}finally{ne()}}function F(n,t,a){var o=Object.keys(n);if(!o.length)return a(B.array(n)?[]:{});var i=0,s=void 0,c={},u={};o.forEach(function(r){var e=function(e,t){s||(t||oe(e)||e===Ne||e===Re?(a.cancel(),a(e,t)):(c[r]=e,++i===o.length&&(s=!0,a(B.array(n)?H.from(Ce({},c,{length:o.length})):c))))};e.cancel=$,u[r]=e}),a.cancel=function(){s||(s=!0,o.forEach(function(e){return u[e].cancel()}))},o.forEach(function(e){return M(n[e],t,e,u[e])})}}Me="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")();var Ge,Fe,qe=("function"==typeof(Fe=Me.Symbol)?Fe.observable?Ge=Fe.observable:(Ge=Fe("observable"),Fe.observable=Ge):Ge="@@observable",Ge),$e=function(){return Math.random().toString(36).substring(7).split("").join(".")},Be={INIT:"@@redux/INIT"+$e(),REPLACE:"@@redux/REPLACE"+$e(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+$e()}};function Ve(e,t,r){var n;if("function"==typeof t&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function");if("function"==typeof t&&void 0===r&&(r=t,t=void 0),void 0!==r){if("function"!=typeof r)throw Error("Expected the enhancer to be a function.");return r(Ve)(e,t)}if("function"!=typeof e)throw Error("Expected the reducer to be a function.");var a=e,o=t,i=[],s=i,c=!1;function u(){s===i&&(s=i.slice())}function p(){if(c)throw Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return o}function l(t){if("function"!=typeof t)throw Error("Expected the listener to be a function.");if(c)throw Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var r=!0;return u(),s.push(t),function(){if(r){if(c)throw Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");r=!1,u();var e=s.indexOf(t);s.splice(e,1)}}}function f(e){if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e))throw Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(c)throw Error("Reducers may not dispatch actions.");try{c=!0,o=a(o,e)}finally{c=!1}for(var t=i=s,r=0;r<t.length;r++){(0,t[r])()}return e}return f({type:Be.INIT}),(n={dispatch:f,subscribe:l,getState:p,replaceReducer:function(e){if("function"!=typeof e)throw Error("Expected the nextReducer to be a function.");a=e,f({type:Be.REPLACE})}})[qe]=function(){var e,r=l;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function t(){e.next&&e.next(p())}return t(),{unsubscribe:r(t)}}})[qe]=function(){return this},e},n}function ze(){for(var e=arguments.length,o=Array(e),t=0;t<e;t++)o[t]=arguments[t];return function(a){return function(){var e=a.apply(void 0,arguments),t=function(){throw Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},r={getState:e.getState,dispatch:function(){return t.apply(void 0,arguments)}},n=o.map(function(e){return e(r)});return function(a){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{},t=Object.keys(o);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(o).filter(function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable}))),t.forEach(function(e){var t,r,n;n=o[r=e],r in(t=a)?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n})}return a}({},e,{dispatch:t=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}.apply(void 0,n)(e.dispatch)})}}}var He={}.hasOwnProperty;function We(e,t){return He.call(t,e)}var Ke=Array.isArray;function Ye(e){return"object"==typeof e&&null!==e&&!Ke(e)}function Ze(r,n){return Object.keys(n).reduce(function(e,t){return e[t]=r(n[t]),e},{})}function Je(e){return Ke(e)?e.map(Je):Ye(e)?Ze(Je,e):e}function Qe(e){var t=e.trim();return 0===t.length?"":1===t.length?t.toLowerCase():/^[a-z\d]+$/.test(t)?t:(t!==t.toLowerCase()&&(t=function(e){for(var t=e,r=!1,n=!1,a=!1,o=0;o<t.length;o++){var i=t[o];r&&/[a-zA-Z]/.test(i)&&i.toUpperCase()===i?(t=t.slice(0,o)+"-"+t.slice(o),a=n,n=!(r=!1),o++):n&&a&&/[a-zA-Z]/.test(i)&&i.toLowerCase()===i?(t=t.slice(0,o-1)+"-"+t.slice(o-1),a=n,r=!(n=!1)):(r=i.toLowerCase()===i,a=n,n=i.toUpperCase()===i)}return t}(t)),t=t.replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,function(e,t){return t.toUpperCase()}))}function Xe(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}function et(e){return null==e}function tt(e,t){for(var r=0;r<t.length;r++){var n=t[r];if(e(n))return n}}function rt(t,r){return tt(function(e){return t(r[e])},Object.keys(r))}function nt(e){return e}function at(t,r){return Object.keys(r).forEach(function(e){t(r[e],e)})}function ot(e){return e.reduce(function(e,t){return e[t[0]]=t[1],e},{})}function it(e){var t=Math.random().toString(36).substring(2);return We(t,e)?it(e):t}function st(e,t){for(var r="string"==typeof e?e.split("."):e,n=0,a=t;a&&n<r.length;)a=a[r[n++]];return a}function ct(e,t,r){var n=st(t,r);return null!=n?n:e}function ut(e){return 0===(Ke(e)?e:Object.keys(e)).length}function pt(r,n){return Object.keys(n).reduce(function(e,t){return e[r(t)]=n[t],e},{})}function lt(a,o){if(ut(o))return a;var i={};return at(function(e,t){if(We(t,o))if(Ye(a[t])&&Ye(o[t]))i[t]=lt(a[t],o[t]);else if(Ke(a[t])&&Ke(o[t])){var r=Math.max(a[t].length,o[t].length);i[t]=Array(r);for(var n=0;n<r;n++)n in o[t]?i[t][n]=o[t][n]:n in a[t]&&(i[t][n]=a[t][n])}else i[t]=o[t];else i[t]=a[t]},a),at(function(e,t){We(t,i)||(i[t]=o[t])},o),i}function ft(e){if(0===e.length)return{};var t=e[0];return e.slice(1).reduce(function(e,t){return lt(e,t)},t)}function dt(t){return Object.keys(t).map(function(e){return t[e]})}function ht(r,e){return n=function(e,t){return-1!=r.indexOf(t)},Object.keys(a=e).reduce(function(e,t){return n(a[t],t)||(e[t]=a[t]),e},{});var n,a}function mt(r,n){return Object.keys(n).reduce(function(e,t){return r(n[t])||(e[t]=n[t]),e},{})}function gt(e,r){return e.reduce(function(e,t){return e[t]=r[t],e},{})}function vt(){return(vt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function yt(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)t.indexOf(r=o[n])<0&&(a[r]=e[r]);return a}var xt=/^\s+/;var bt=/\s+$/;var _t,wt,kt,It=function(r,n){var e=function e(){var t=n.apply(void 0,arguments);return"function"==typeof t?e:{type:r,payload:t}};return e.getActionName=function(){return r},e.toString=function(){return r},e},Tt=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},Et=function(n){var e;return(e={})["SET_PROPERTY_"+n.toUpperCase()]=function(e,t){var r;return vt({},e,((r={})[n]=t.data,r))},e["REMOVE_PROPERTY_"+n.toUpperCase()]=function(e){return vt({},ht([n],e))},e},St=function(t){var e;return(e={})["getProperty"+Tt(t)]=function(e){return e[t]},e},Pt=function(e){var t;return(t={})["setProperty"+Tt(e)]=It("SET_PROPERTY_"+e.toUpperCase(),function(e,t){return void 0===t&&(t={}),{data:e,meta:t}}),t["removeProperty"+Tt(e)]=It("REMOVE_PROPERTY_"+e.toUpperCase(),function(){return{propName:e}}),t},Ct={LICENSE:"license",GROUP:"group",SESSION_ID:"sessionId",SECURED_TOKEN:"securedToken",CHAT_ID:"chatId",CHAT_STATE:"chatState",CHAT_STATUS:"chatStatus",VISITOR_ID:"visitorId",CUSTOM_VISITOR_ID:"customVisitorId",LAST_MESSAGE_ID:"lastMessageId",CONNECTION_STATUS:"connectionStatus",SNEAK_PEEK:"sneakPeek",TICKET_FORM:"ticketForm",PRE_CHAT_FORM:"preChatForm",POST_CHAT_FORM:"postChatForm",STATIC_CONFIG_VERSION:"staticConfigVersion",TRANSLATIONS_VERSION:"translationsVersion",TRANSLATIONS:"translations",SECRET_ID:"secretId",REGION:"region",CONFIG_LOADED:"configLoaded",LAST_AGENT_ID:"lastAgentId",DYNAMIC_CONFIG:"dynamicConfig",CONFIG:"config",WELCOME_MESSAGE:"welcomeMessage",ACCEPTED_INVITATION:"acceptedInvitation",SERVER_IDS_MAP:"serverIdsMap",VISITOR_CUSTOM_ID_MAP:"visitorCustomIdMap",CLIENT_LIMIT_EXCEEDED:"clientLimitExceeded",PING_SENT:"pingSent",CHAT_BETWEEN_GROUPS:"chatBetweenGroups",HISTORY_LOADED:"historyLoaded",REQUEST_DISTRIBUTION:"requestDistribution",MOBILE:"mobile"},At=vt({},Pt(Ct.LICENSE),Pt(Ct.GROUP),Pt(Ct.SESSION_ID),Pt(Ct.SECURED_TOKEN),Pt(Ct.CHAT_ID),Pt(Ct.CHAT_STATE),Pt(Ct.VISITOR_ID),Pt(Ct.CUSTOM_VISITOR_ID),Pt(Ct.LAST_MESSAGE_ID),Pt(Ct.CHAT_STATUS),Pt(Ct.CONNECTION_STATUS),Pt(Ct.SNEAK_PEEK),Pt(Ct.TICKET_FORM),Pt(Ct.STATIC_CONFIG_VERSION),Pt(Ct.SECRET_ID),Pt(Ct.REGION),Pt(Ct.CONFIG_LOADED),Pt(Ct.LAST_AGENT_ID),Pt(Ct.PRE_CHAT_FORM),Pt(Ct.TRANSLATIONS_VERSION),Pt(Ct.TRANSLATIONS),Pt(Ct.POST_CHAT_FORM),Pt(Ct.CONFIG),Pt(Ct.DYNAMIC_CONFIG),Pt(Ct.WELCOME_MESSAGE),Pt(Ct.ACCEPTED_INVITATION),Pt(Ct.SERVER_IDS_MAP),Pt(Ct.VISITOR_CUSTOM_ID_MAP),Pt(Ct.CLIENT_LIMIT_EXCEEDED),Pt(Ct.PING_SENT),Pt(Ct.CHAT_BETWEEN_GROUPS),Pt(Ct.HISTORY_LOADED),Pt(Ct.REQUEST_DISTRIBUTION),Pt(Ct.MOBILE)),Ot=It("CHAT_STARTED",function(e){return{securedToken:e.securedToken,welcomeMessage:e.welcomeMessage,visitorMessage:e.visitorMessage}}),Nt=It("NEW_MESSAGE",function(e){return{id:e.id,timestamp:e.timestamp,authorType:e.authorType,authorId:e.authorId,text:e.text,chatId:e.chatId,isMobile:e.isMobile,customId:e.customId,serverId:e.serverId,json:e.json}}),Rt=It("CHAT_ENDED",function(e){return{reason:(void 0===e?{}:e).reason}}),jt=It("NEW_AGENT",function(e){var t=e.fromInvitation,r=e.trigger;return{avatarUrl:e.avatarUrl,jobTitle:e.jobTitle,name:e.name,id:e.id,fromInvitation:void 0!==t&&t,trigger:void 0===r?null:r}}),Lt=It("VISITOR_DATA_SET",function(e){return{visitorData:e.visitorData,requestId:e.requestId}}),Mt=It("VISITOR_DATA_SET_ERROR",function(e){return{error:e.error,requestId:e.requestId}}),Dt=It("NEW_FILE",function(e){return{id:e.id,timestamp:e.timestamp,authorType:e.authorType,authorId:e.authorId,url:e.url,size:e.size,contentType:e.contentType,attachmentToken:e.attachmentToken,thumbnail:e.thumbnail}}),Ut=It("VISITOR_QUEUED",function(e){return{numberInQueue:e.numberInQueue,waitingTime:e.waitingTime}}),Gt=It("TYPING_INDICATOR",function(e){return{authorId:e.authorId,isTyping:e.isTyping}}),Ft=It("RATE_CHAT",function(e){return{rate:e.rate,comment:e.comment}}),qt=It("SET_VISITOR_DATA",function(e){var t=e.internal;return{visitorData:e.visitorData,requestId:e.requestId,internal:void 0!==t&&t}}),$t=It("SEND_FILE",function(e){return{file:e.file,customId:e.customId}}),Bt=It("REQUEST_FILE_TOKEN",function(e){return{customId:e.customId}}),Vt=It("FILE_TOKEN_RECEIVED",function(e){return{customId:e.customId,token:e.token}}),zt=It("NEW_INVITATION",function(e){return{id:e.id,authorId:e.authorId,text:e.text,receivedFirstTime:e.receivedFirstTime}}),Ht=It("MESSAGE_SEEN",function(e){return{id:e.id,customId:e.customId,type:e.type}}),Wt=It("PROTOCOL_UPGRADED",function(){}),Kt=It("INTEGRATION_DATA",function(e){return{id:e.id,timestamp:e.timestamp,integrationName:e.integrationName,data:e.data}}),Yt=Object.freeze({chatStarted:Ot,newMessage:Nt,chatEnded:Rt,newAgent:jt,visitorDataSet:Lt,visitorDataSetError:Mt,newFile:Dt,visitorQueued:Ut,typingIndicator:Gt,rateChat:Ft,setVisitorData:qt,sendFile:$t,requestFileToken:Bt,fileTokenReceived:Vt,newInvitation:zt,messageSeen:Ht,protocolUpgraded:Wt,integrationData:Kt}),Zt=Xe(ft,function(e){return e.map(Et)},dt)(Ct),Jt=Xe(ft,function(e){return e.map(St)},dt)(Ct),Qt=function(e){return e.environment},Xt=((_t={})[qt.getActionName()]=function(e,t){return vt({},e,{visitorData:t.visitorData})},_t),er=function(e){return e.visitorData},tr=(wt={},(kt=vt({},Xt,Zt))[void 0]&&console.warn("Reducer contains an 'undefined' action type.\nHave you misspelled a constant?"),function(e,t){return void 0===e&&(e=wt),We(t.type,kt)?kt[t.type](e,t.payload):e}),rr="runSaga(storeInterface, saga, ...args): saga argument must be a Generator function!";function nr(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.context,o=void 0===t?{}:t,i=function(e,t){var r={};for(var n in e)t.indexOf(n)<0&&Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(e,["context"]),s=i.sagaMonitor,c=i.logger,u=i.onError;if(B.func(i))throw Error("Saga middleware no longer accept Generator functions. Use sagaMiddleware.run instead");if(c&&!B.func(c))throw Error("`options.logger` passed to the Saga middleware is not a function!");if(u&&!B.func(u))throw Error("`options.onError` passed to the Saga middleware is not a function!");if(i.emitter&&!B.func(i.emitter))throw Error("`options.emitter` passed to the Saga middleware is not a function!");function p(e){var a,t=e.getState,r=e.dispatch,n=(a=[],{subscribe:function(e){return a.push(e),function(){return z(a,e)}},emit:function(e){for(var t=a.slice(),r=0,n=t.length;r<n;r++)t[r](e)}});return n.emit=(i.emitter||l)(n.emit),p.run=function(e,t){for(var r=arguments.length,n=Array(2<r?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];var o=void 0;B.iterator(e)?(o=e,e=t):(I(t,B.func,rr),I(o=t.apply(void 0,n),B.iterator,rr));var i=e.subscribe,s=e.dispatch,c=e.getState,u=e.context,p=e.sagaMonitor,l=e.logger,f=e.onError,d=W();p&&(p.effectTriggered=p.effectTriggered||$,p.effectResolved=p.effectResolved||$,p.effectRejected=p.effectRejected||$,p.effectCancelled=p.effectCancelled||$,p.actionDispatched=p.actionDispatched||$,p.effectTriggered({effectId:d,root:!0,parentEffectId:0,effect:{root:!0,saga:t,args:n}}));var h=Ue(o,i,m(s),c,u,{sagaMonitor:p,logger:l,onError:f},d,t.name);return p&&p.effectResolved(d,h),h}.bind(null,{context:o,subscribe:n.subscribe,dispatch:r,getState:t,sagaMonitor:s,logger:c,onError:u}),function(r){return function(e){s&&s.actionDispatched&&s.actionDispatched(e);var t=r(e);return n.emit(e),t}}}return p.run=function(){throw Error("Before running a Saga, you must mount the Saga middleware on the Store using applyMiddleware")},p.setContext=function(e){I(e,B.object,Q("sagaMiddleware",e)),V.assign(o,e)},p}var ar="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function or(e,t){return e(t={exports:{}},t.exports),t.exports}var ir=or(function(e){var t=function(o){var c,e=Object.prototype,u=e.hasOwnProperty,t="function"==typeof Symbol?Symbol:{},a=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",n=t.toStringTag||"@@toStringTag";function i(e,t,r,n){var o,i,s,c,a=Object.create((t&&t.prototype instanceof g?t:g).prototype),u=new S(n||[]);return a._invoke=(o=e,i=r,s=u,c=l,function(e,t){if(c===d)throw Error("Generator is already running");if(c===h){if("throw"===e)throw t;return C()}for(s.method=e,s.arg=t;;){var r=s.delegate;if(r){var n=I(r,s);if(n){if(n===m)continue;return n}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(c===l)throw c=h,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);c=d;var a=p(o,i,s);if("normal"===a.type){if(c=s.done?h:f,a.arg===m)continue;return{value:a.arg,done:s.done}}"throw"===a.type&&(c=h,s.method="throw",s.arg=a.arg)}}),a}function p(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}o.wrap=i;var l="suspendedStart",f="suspendedYield",d="executing",h="completed",m={};function g(){}function s(){}function v(){}var y={};y[a]=function(){return this};var x=Object.getPrototypeOf,b=x&&x(x(P([])));b&&b!==e&&u.call(b,a)&&(y=b);var _=v.prototype=g.prototype=Object.create(y);function w(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function k(c){var t;this._invoke=function(r,n){function e(){return new Promise(function(e,t){!function t(e,r,n,a){var o=p(c[e],c,r);if("throw"!==o.type){var i=o.arg,s=i.value;return s&&"object"==typeof s&&u.call(s,"__await")?Promise.resolve(s.__await).then(function(e){t("next",e,n,a)},function(e){t("throw",e,n,a)}):Promise.resolve(s).then(function(e){i.value=e,n(i)},function(e){return t("throw",e,n,a)})}a(o.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}}function I(e,t){var r=e.iterator[t.method];if(r===c){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=c,I(e,t),"throw"===t.method))return m;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var n=p(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,m;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=c),t.delegate=null,m):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,n=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=c,e.done=!0,e};return n.next=n}}return{next:C}}function C(){return{value:c,done:!0}}return s.prototype=_.constructor=v,v.constructor=s,v[n]=s.displayName="GeneratorFunction",o.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===s||"GeneratorFunction"===(t.displayName||t.name))},o.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,n in e||(e[n]="GeneratorFunction")),e.prototype=Object.create(_),e},o.awrap=function(e){return{__await:e}},w(k.prototype),k.prototype[r]=function(){return this},o.AsyncIterator=k,o.async=function(e,t,r,n){var a=new k(i(e,t,r,n));return o.isGeneratorFunction(t)?a:a.next().then(function(e){return e.done?e.value:a.next()})},w(_),_[n]="Generator",_[a]=function(){return this},_.toString=function(){return"[object Generator]"},o.keys=function(r){var n=[];for(var e in r)n.push(e);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},o.values=P,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=c,this.done=!1,this.delegate=null,this.method="next",this.arg=c,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=c)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=c),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var a=this.tryEntries[t],o=a.completion;if("root"===a.tryLoc)return e("end");if(a.tryLoc<=this.prev){var i=u.call(a,"catchLoc"),s=u.call(a,"finallyLoc");if(i&&s){if(this.prev<a.catchLoc)return e(a.catchLoc,!0);if(this.prev<a.finallyLoc)return e(a.finallyLoc)}else if(i){if(this.prev<a.catchLoc)return e(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return e(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}!a||"break"!==e&&"continue"!==e||t<a.tryLoc||a.finallyLoc<t||(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;E(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:P(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=c),m}},o}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}),sr=It("PUBLIC_SEND_MESSAGE",function(e){return{customId:e.customId+"",text:e.text,json:e.json,promise:e.promise}}),cr=(It("PUBLIC_INIT",function(e){return{license:e.license,group:e.group}}),It("PUBLIC_SET_VISITOR_DATA",function(e){var t=e.update;return{name:e.name,email:e.email,customProperties:e.customProperties,pageUrl:e.pageUrl,pageTitle:e.pageTitle,promise:e.promise,update:void 0===t||t}})),ur=It("GET_VISITOR_DATA",function(e){return{promise:e.promise}}),pr=(It("PUBLIC_CALLBACK_ERROR",function(e){return{errorMessage:e.errorMessage}}),It("PUBLIC_RATE_CHAT",function(e){return{rate:e.rate,comment:e.comment,promise:e.promise}})),lr=It("PUBLIC_SET_SNEAK_PEEK",function(e){return{text:e.text,promise:e.promise}}),fr=It("PUBLIC_FORWARD_CHAT_TRANSCRIPT",function(e){return{email:e.email,promise:e.promise}}),dr=It("PUBLIC_CLOSE_CHAT",function(e){return{promise:e.promise}}),hr=It("PUBLIC_DISCONNECT",function(e){return{promise:e.promise}}),mr=It("PUBLIC_GET_TICKET_FORM",function(e){return{promise:e.promise,group:e.group}}),gr=It("PUBLIC_SEND_TICKET_FORM",function(e){return{answers:e.answers,promise:e.promise}}),vr=It("PUBLIC_SEND_FILE",function(e){return{file:e.file,customId:e.customId,promise:e.promise,onProgress:e.onProgress}}),yr=It("PUBLIC_SEND_FILE",function(e){return{customId:e.customId}}),xr=It("PUBLIC_GET_PRECHAT_FORM",function(e){return{promise:e.promise}}),br=It("PUBLIC_SEND_PRECHAT_FORM",function(e){return{promise:e.promise,answers:e.answers}}),_r=It("PUBLIC_GET_TRANSLATIONS",function(e){return{promise:e.promise}}),wr=It("PUBLIC_GET_PREDICTED_AGENT",function(e){return{promise:e.promise}}),kr=It("PUBLIC_GET_POSTCHAT_FORM",function(e){return{promise:e.promise}}),Ir=It("PUBLIC_SEND_POSTCHAT_FORM",function(e){return{promise:e.promise,answers:e.answers}}),Tr=It("PUBLIC_GET_CONFIG",function(e){return{promise:e.promise}}),Er=It("PUBLIC_ACCEPT_INVITATION",function(e){return{promise:e.promise,id:e.id}}),Sr=It("PUBLIC_MESSAGE_AS_SEEN",function(e){return{promise:e.promise,messageId:e.messageId}}),Pr=It("PUBLIC_START_CHAT",function(e){return{promise:e.promise}}),Cr=It("PUBLIC_CHECK_GROUP_STATUS",function(e){return{group:e.group,promise:e.promise}}),Ar=It("PUBLIC_SET_VISITOR_GROUP",function(e){return{group:e.group}}),Or=It("PUBLIC_GET_QUEUE_FORM",function(e){return{promise:e.promise}}),Nr=or(function(e){var t=function(o){var c,e=Object.prototype,u=e.hasOwnProperty,t="function"==typeof Symbol?Symbol:{},a=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",n=t.toStringTag||"@@toStringTag";function i(e,t,r,n){var o,i,s,c,a=Object.create((t&&t.prototype instanceof g?t:g).prototype),u=new S(n||[]);return a._invoke=(o=e,i=r,s=u,c=l,function(e,t){if(c===d)throw Error("Generator is already running");if(c===h){if("throw"===e)throw t;return C()}for(s.method=e,s.arg=t;;){var r=s.delegate;if(r){var n=I(r,s);if(n){if(n===m)continue;return n}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(c===l)throw c=h,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);c=d;var a=p(o,i,s);if("normal"===a.type){if(c=s.done?h:f,a.arg===m)continue;return{value:a.arg,done:s.done}}"throw"===a.type&&(c=h,s.method="throw",s.arg=a.arg)}}),a}function p(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}o.wrap=i;var l="suspendedStart",f="suspendedYield",d="executing",h="completed",m={};function g(){}function s(){}function v(){}var y={};y[a]=function(){return this};var x=Object.getPrototypeOf,b=x&&x(x(P([])));b&&b!==e&&u.call(b,a)&&(y=b);var _=v.prototype=g.prototype=Object.create(y);function w(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function k(c){var t;this._invoke=function(r,n){function e(){return new Promise(function(e,t){!function t(e,r,n,a){var o=p(c[e],c,r);if("throw"!==o.type){var i=o.arg,s=i.value;return s&&"object"==typeof s&&u.call(s,"__await")?Promise.resolve(s.__await).then(function(e){t("next",e,n,a)},function(e){t("throw",e,n,a)}):Promise.resolve(s).then(function(e){i.value=e,n(i)},function(e){return t("throw",e,n,a)})}a(o.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}}function I(e,t){var r=e.iterator[t.method];if(r===c){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=c,I(e,t),"throw"===t.method))return m;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var n=p(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,m;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=c),t.delegate=null,m):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,n=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=c,e.done=!0,e};return n.next=n}}return{next:C}}function C(){return{value:c,done:!0}}return s.prototype=_.constructor=v,v.constructor=s,v[n]=s.displayName="GeneratorFunction",o.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===s||"GeneratorFunction"===(t.displayName||t.name))},o.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,n in e||(e[n]="GeneratorFunction")),e.prototype=Object.create(_),e},o.awrap=function(e){return{__await:e}},w(k.prototype),k.prototype[r]=function(){return this},o.AsyncIterator=k,o.async=function(e,t,r,n){var a=new k(i(e,t,r,n));return o.isGeneratorFunction(t)?a:a.next().then(function(e){return e.done?e.value:a.next()})},w(_),_[n]="Generator",_[a]=function(){return this},_.toString=function(){return"[object Generator]"},o.keys=function(r){var n=[];for(var e in r)n.push(e);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},o.values=P,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=c,this.done=!1,this.delegate=null,this.method="next",this.arg=c,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=c)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=c),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var a=this.tryEntries[t],o=a.completion;if("root"===a.tryLoc)return e("end");if(a.tryLoc<=this.prev){var i=u.call(a,"catchLoc"),s=u.call(a,"finallyLoc");if(i&&s){if(this.prev<a.catchLoc)return e(a.catchLoc,!0);if(this.prev<a.finallyLoc)return e(a.finallyLoc)}else if(i){if(this.prev<a.catchLoc)return e(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return e(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}!a||"break"!==e&&"continue"!==e||t<a.tryLoc||a.finallyLoc<t||(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;E(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:P(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=c),m}},o}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}});function Rr(e){this.ms=(e=e||{}).min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=0<e.jitter&&e.jitter<=1?e.jitter:0,this.attempts=0}Rr.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-r:e+r}return 0|Math.min(e,this.max)},Rr.prototype.reset=function(){this.attempts=0},Rr.prototype.setMin=function(e){this.ms=e},Rr.prototype.setMax=function(e){this.max=e},Rr.prototype.setJitter=function(e){this.jitter=e};var jr=Nr.mark(Lr);function Lr(t){var r,n,a,o,i=arguments;return Nr.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=Array(1<(r=i.length)?r-1:0),a=1;a<r;a++)n[a-1]=i[a];case 1:return e.next=3,ke.apply(void 0,[t].concat(n));case 3:if(void 0!==(o=e.sent))return e.abrupt("return",o);e.next=6;break;case 6:return e.next=8,de("*");case 8:e.next=1;break;case 9:case"end":return e.stop()}},jr)}var Mr=function(t){return xe(Nr.mark(function e(){return Nr.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t;case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",null);case 9:case"end":return e.stop()}},e,null,[[0,6]])}))},Dr="__test_storage_support__",Ur=function(){var r=Object.create(null);return{getItem:function(e){var t=r[e];return"string"==typeof t?t:null},setItem:function(e,t){r[e]=t},removeItem:function(e){delete r[e]},clear:function(){r=Object.create(null)}}}(),Gr="undefined"!=typeof document,Fr="",qr=function(e){void 0===e&&(e="local");try{var t="session"===e?window.sessionStorage:window.localStorage;return t.setItem(Dr,"@@test"),"@@test"===t.getItem(Dr)&&(t.removeItem(Dr),!0)}catch(e){return!1}}()?window.localStorage:Ur,$r={setItem:function(e,t){qr.setItem(Fr+e,t)},getItem:function(e){return qr.getItem(Fr+e)},removeItem:function(e){qr.removeItem(Fr+e)},setPrefix:function(e){Fr=e},removeOldSecretTokenCookie:function(e){Gr&&(document.cookie="secret_token_"+e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/licence/"+e+"/v2;domain=.livechatinc.com",document.cookie="secret_token_"+e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/licence/"+e+";domain=.livechatinc.com")}},Br=function(e){return(t=e,Object.keys(t).map(function(e){return[e,t[e]]})).map(function(e){return e.map(encodeURIComponent).join("=")}).join("&");var t},Vr=function(e){return ot(e.split("&").map(function(e){return e.split("=").map(decodeURIComponent)}))},zr=/.*?\?([^#]+)/,Hr=function(e){var t,r=(t=e.match(zr),(t?"?"+t[1]:"").replace(/^\?/,""));return Vr(r||e)},Wr=/^((http(s)?:)?\/\/)/,Kr=function(e){return e.replace(Wr,"")};function Yr(e){return-1!=e.indexOf("cdn.livechatinc.com/cloud/?uri")?"https://"+Kr(e):"https://cdn.livechatinc.com/cloud/?uri=http://"+encodeURI(Kr(e))}function Zr(e){var t=e.agent;return{invitation:{id:e.unique_id,authorId:t.login,text:e.greeting_message.text,receivedFirstTime:e.displayed_first_time},agent:{avatarUrl:Yr(t.avatar_url),jobTitle:t.job_title,name:t.name,id:t.login}}}var Jr=Object.getOwnPropertySymbols,Qr=Object.prototype.hasOwnProperty,Xr=Object.prototype.propertyIsEnumerable;var en=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var r,n,a=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),o=1;o<arguments.length;o++){for(var i in r=Object(arguments[o]))Qr.call(r,i)&&(a[i]=r[i]);if(Jr){n=Jr(r);for(var s=0;s<n.length;s++)Xr.call(r,n[s])&&(a[n[s]]=r[n[s]])}}return a},tn="function"==typeof Symbol&&Symbol.for,rn=tn?Symbol.for("react.element"):60103,nn=tn?Symbol.for("react.portal"):60106,an=tn?Symbol.for("react.fragment"):60107,on=tn?Symbol.for("react.strict_mode"):60108,sn=tn?Symbol.for("react.profiler"):60114,cn=tn?Symbol.for("react.provider"):60109,un=tn?Symbol.for("react.context"):60110,pn=tn?Symbol.for("react.concurrent_mode"):60111,ln=tn?Symbol.for("react.forward_ref"):60112,fn=tn?Symbol.for("react.suspense"):60113,dn=tn?Symbol.for("react.memo"):60115,hn=tn?Symbol.for("react.lazy"):60116,mn="function"==typeof Symbol&&Symbol.iterator;function gn(e){for(var t=arguments.length-1,r="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=0;n<t;n++)r+="&args[]="+encodeURIComponent(arguments[n+1]);!function(e,t,r,n,a,o,i,s){if(!e){if((e=void 0)===t)e=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[r,n,a,o,i,s],u=0;(e=Error(t.replace(/%s/g,function(){return c[u++]}))).name="Invariant Violation"}throw e.framesToPop=1,e}}(!1,"Minified React error #"+e+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",r)}var vn={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},yn={};function xn(e,t,r){this.props=e,this.context=t,this.refs=yn,this.updater=r||vn}function bn(){}function _n(e,t,r){this.props=e,this.context=t,this.refs=yn,this.updater=r||vn}xn.prototype.isReactComponent={},xn.prototype.setState=function(e,t){"object"!=typeof e&&"function"!=typeof e&&null!=e&&gn("85"),this.updater.enqueueSetState(this,e,t,"setState")},xn.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},bn.prototype=xn.prototype;var wn=_n.prototype=new bn;wn.constructor=_n,en(wn,xn.prototype);var kn={current:null},In={current:null},Tn=Object.prototype.hasOwnProperty,En={key:wn.isPureReactComponent=!0,ref:!0,__self:!0,__source:!0};function Sn(e,t,r){var n=void 0,a={},o=null,i=null;if(null!=t)for(n in void 0!==t.ref&&(i=t.ref),void 0!==t.key&&(o=""+t.key),t)Tn.call(t,n)&&!En.hasOwnProperty(n)&&(a[n]=t[n]);var s=arguments.length-2;if(1===s)a.children=r;else if(1<s){for(var c=Array(s),u=0;u<s;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(n in s=e.defaultProps)void 0===a[n]&&(a[n]=s[n]);return{$$typeof:rn,type:e,key:o,ref:i,props:a,_owner:In.current}}function Pn(e){return"object"==typeof e&&null!==e&&e.$$typeof===rn}var Cn=/\/+/g,An=[];function On(e,t,r,n){if(An.length){var a=An.pop();return a.result=e,a.keyPrefix=t,a.func=r,a.context=n,a.count=0,a}return{result:e,keyPrefix:t,func:r,context:n,count:0}}function Nn(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,An.length<10&&An.push(e)}function Rn(e,t,r){return null==e?0:function e(t,r,n,a){var o=typeof t;"undefined"!==o&&"boolean"!==o||(t=null);var i=!1;if(null===t)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case rn:case nn:i=!0}}if(i)return n(a,t,""===r?"."+jn(t,0):r),1;if(i=0,r=""===r?".":r+":",Array.isArray(t))for(var s=0;s<t.length;s++){var c=r+jn(o=t[s],s);i+=e(o,c,n,a)}else if("function"==typeof(c=null===t||"object"!=typeof t?null:"function"==typeof(c=mn&&t[mn]||t["@@iterator"])?c:null))for(t=c.call(t),s=0;!(o=t.next()).done;)i+=e(o=o.value,c=r+jn(o,s++),n,a);else"object"===o&&gn("31","[object Object]"==(n=""+t)?"object with keys {"+Object.keys(t).join(", ")+"}":n,"");return i}(e,"",t,r)}function jn(e,t){return"object"==typeof e&&null!==e&&null!=e.key?(r={"=":"=0",":":"=2"},"$"+(""+e.key).replace(/[=:]/g,function(e){return r[e]})):t.toString(36);var r}function Ln(e,t){e.func.call(e.context,t,e.count++)}function Mn(e,t,r){var n,a=e.result,o=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?Dn(e,a,r,function(e){return e}):null!=e&&(Pn(e)&&(e={$$typeof:rn,type:(n=e).type,key:o+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(Cn,"$&/")+"/")+r,ref:n.ref,props:n.props,_owner:n._owner}),a.push(e))}function Dn(e,t,r,n,a){var o="";null!=r&&(o=(""+r).replace(Cn,"$&/")+"/"),Rn(e,Mn,t=On(t,o,n,a)),Nn(t)}function Un(){var e=kn.current;return null===e&&gn("307"),e}var Gn,Fn={Children:{map:function(e,t,r){if(null==e)return e;var n=[];return Dn(e,n,null,t,r),n},forEach:function(e,t,r){if(null==e)return e;Rn(e,Ln,t=On(null,null,t,r)),Nn(t)},count:function(e){return Rn(e,function(){return null},null)},toArray:function(e){var t=[];return Dn(e,t,null,function(e){return e}),t},only:function(e){return Pn(e)||gn("143"),e}},createRef:function(){return{current:null}},Component:xn,PureComponent:_n,createContext:function(e,t){return void 0===t&&(t=null),(e={$$typeof:un,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:cn,_context:e},e.Consumer=e},forwardRef:function(e){return{$$typeof:ln,render:e}},lazy:function(e){return{$$typeof:hn,_ctor:e,_status:-1,_result:null}},memo:function(e,t){return{$$typeof:dn,type:e,compare:void 0===t?null:t}},useCallback:function(e,t){return Un().useCallback(e,t)},useContext:function(e,t){return Un().useContext(e,t)},useEffect:function(e,t){return Un().useEffect(e,t)},useImperativeHandle:function(e,t,r){return Un().useImperativeHandle(e,t,r)},useDebugValue:function(){},useLayoutEffect:function(e,t){return Un().useLayoutEffect(e,t)},useMemo:function(e,t){return Un().useMemo(e,t)},useReducer:function(e,t,r){return Un().useReducer(e,t,r)},useRef:function(e){return Un().useRef(e)},useState:function(e){return Un().useState(e)},Fragment:an,StrictMode:on,Suspense:fn,createElement:Sn,cloneElement:function(e,t,r){null==e&&gn("267",e);var n=void 0,a=en({},e.props),o=e.key,i=e.ref,s=e._owner;if(null!=t){void 0!==t.ref&&(i=t.ref,s=In.current),void 0!==t.key&&(o=""+t.key);var c=void 0;for(n in e.type&&e.type.defaultProps&&(c=e.type.defaultProps),t)Tn.call(t,n)&&!En.hasOwnProperty(n)&&(a[n]=void 0===t[n]&&void 0!==c?c[n]:t[n])}if(1===(n=arguments.length-2))a.children=r;else if(1<n){c=Array(n);for(var u=0;u<n;u++)c[u]=arguments[u+2];a.children=c}return{$$typeof:rn,type:e.type,key:o,ref:i,props:a,_owner:s}},createFactory:function(e){var t=Sn.bind(null,e);return t.type=e,t},isValidElement:Pn,version:"16.8.3",unstable_ConcurrentMode:pn,unstable_Profiler:sn,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentDispatcher:kn,ReactCurrentOwner:In,assign:en}},qn=Fn.default||Fn,$n=(or(function(e){}),or(function(e){e.exports=qn}),or(function(y,e){!function(e){var x={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:/^ {0,3}(`{3,}|~{3,})([^`~\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?:\n+|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6}) +([^\n]*?)(?: +#+)? *(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3})(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?\\?>\\n*|<![A-Z][\\s\\S]*?>\\n*|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>\\n*|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:\\n{2,}|$)|<(?!script|pre|style)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:\\n{2,}|$)|</(?!script|pre|style)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:\\n{2,}|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,nptable:d,table:d,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html)[^\n]+)*)/,text:/^[^\n]+/};function c(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||v.defaults,this.rules=x.normal,this.options.pedantic?this.rules=x.pedantic:this.options.gfm&&(this.rules=x.gfm)}x._label=/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,x._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/,x.def=o(x.def).replace("label",x._label).replace("title",x._title).getRegex(),x.bullet=/(?:[*+-]|\d{1,9}\.)/,x.item=/^( *)(bull) ?[^\n]*(?:\n(?!\1bull ?)[^\n]*)*/,x.item=o(x.item,"gm").replace(/bull/g,x.bullet).getRegex(),x.list=o(x.list).replace(/bull/g,x.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+x.def.source+")").getRegex(),x._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",x._comment=/<!--(?!-?>)[\s\S]*?-->/,x.html=o(x.html,"i").replace("comment",x._comment).replace("tag",x._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),x.paragraph=o(x._paragraph).replace("hr",x.hr).replace("heading"," {0,3}#{1,6} +").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}|~{3,})[^`\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|!--)").replace("tag",x._tag).getRegex(),x.blockquote=o(x.blockquote).replace("paragraph",x.paragraph).getRegex(),x.normal=h({},x),x.gfm=h({},x.normal,{nptable:/^ *([^|\n ].*\|.*)\n *([-:]+ *\|[-| :]*)(?:\n((?:.*[^>\n ].*(?:\n|$))*)\n*|$)/,table:/^ *\|(.+)\n *\|?( *[-:]+[-| :]*)(?:\n((?: *[^>\n ].*(?:\n|$))*)\n*|$)/}),x.pedantic=h({},x.normal,{html:o("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",x._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *(?:#+ *)?(?:\n+|$)/,fences:d,paragraph:o(x.normal._paragraph).replace("hr",x.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",x.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()}),c.rules=x,c.lex=function(e,t){return new c(t).lex(e)},c.prototype.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(e,!0)},c.prototype.token=function(e,t){var r,n,a,o,i,s,c,u,p,l,f,d,h,m,g,v;for(e=e.replace(/^ +$/gm,"");e;)if((a=this.rules.newline.exec(e))&&(e=e.substring(a[0].length),1<a[0].length&&this.tokens.push({type:"space"})),a=this.rules.code.exec(e)){var y=this.tokens[this.tokens.length-1];e=e.substring(a[0].length),y&&"paragraph"===y.type?y.text+="\n"+a[0].trimRight():(a=a[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",codeBlockStyle:"indented",text:this.options.pedantic?a:w(a,"\n")}))}else if(a=this.rules.fences.exec(e))e=e.substring(a[0].length),this.tokens.push({type:"code",lang:a[2]?a[2].trim():a[2],text:a[3]||""});else if(a=this.rules.heading.exec(e))e=e.substring(a[0].length),this.tokens.push({type:"heading",depth:a[1].length,text:a[2]});else if((a=this.rules.nptable.exec(e))&&(s={type:"table",header:_(a[1].replace(/^ *| *\| *$/g,"")),align:a[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:a[3]?a[3].replace(/\n$/,"").split("\n"):[]}).header.length===s.align.length){for(e=e.substring(a[0].length),f=0;f<s.align.length;f++)s.align[f]=/^ *-+: *$/.test(s.align[f])?"right":/^ *:-+: *$/.test(s.align[f])?"center":/^ *:-+ *$/.test(s.align[f])?"left":null;for(f=0;f<s.cells.length;f++)s.cells[f]=_(s.cells[f],s.header.length);this.tokens.push(s)}else if(a=this.rules.hr.exec(e))e=e.substring(a[0].length),this.tokens.push({type:"hr"});else if(a=this.rules.blockquote.exec(e))e=e.substring(a[0].length),this.tokens.push({type:"blockquote_start"}),a=a[0].replace(/^ *> ?/gm,""),this.token(a,t),this.tokens.push({type:"blockquote_end"});else if(a=this.rules.list.exec(e)){for(e=e.substring(a[0].length),this.tokens.push(c={type:"list_start",ordered:m=1<(o=a[2]).length,start:m?+o:"",loose:!1}),r=!(u=[]),h=(a=a[0].match(this.rules.item)).length,f=0;f<h;f++)l=(s=a[f]).length,~(s=s.replace(/^ *([*+-]|\d+\.) */,"")).indexOf("\n ")&&(l-=s.length,s=s.replace(this.options.pedantic?/^ {1,4}/gm:RegExp("^ {1,"+l+"}","gm"),"")),f!==h-1&&(i=x.bullet.exec(a[f+1])[0],(1<o.length?1===i.length:1<i.length||this.options.smartLists&&i!==o)&&(e=a.slice(f+1).join("\n")+e,f=h-1)),n=r||/\n\n(?!\s*$)/.test(s),f!==h-1&&(r="\n"===s.charAt(s.length-1),n||(n=r)),n&&(c.loose=!0),v=void 0,(g=/^\[[ xX]\] /.test(s))&&(v=" "!==s[1],s=s.replace(/^\[[ xX]\] +/,"")),u.push(p={type:"list_item_start",task:g,checked:v,loose:n}),this.tokens.push(p),this.token(s,!1),this.tokens.push({type:"list_item_end"});if(c.loose)for(h=u.length,f=0;f<h;f++)u[f].loose=!0;this.tokens.push({type:"list_end"})}else if(a=this.rules.html.exec(e))e=e.substring(a[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===a[1]||"script"===a[1]||"style"===a[1]),text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(a[0]):b(a[0]):a[0]});else if(t&&(a=this.rules.def.exec(e)))e=e.substring(a[0].length),a[3]&&(a[3]=a[3].substring(1,a[3].length-1)),d=a[1].toLowerCase().replace(/\s+/g," "),this.tokens.links[d]||(this.tokens.links[d]={href:a[2],title:a[3]});else if((a=this.rules.table.exec(e))&&(s={type:"table",header:_(a[1].replace(/^ *| *\| *$/g,"")),align:a[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:a[3]?a[3].replace(/\n$/,"").split("\n"):[]}).header.length===s.align.length){for(e=e.substring(a[0].length),f=0;f<s.align.length;f++)s.align[f]=/^ *-+: *$/.test(s.align[f])?"right":/^ *:-+: *$/.test(s.align[f])?"center":/^ *:-+ *$/.test(s.align[f])?"left":null;for(f=0;f<s.cells.length;f++)s.cells[f]=_(s.cells[f].replace(/^ *\| *| *\| *$/g,""),s.header.length);this.tokens.push(s)}else if(a=this.rules.lheading.exec(e))e=e.substring(a[0].length),this.tokens.push({type:"heading",depth:"="===a[2].charAt(0)?1:2,text:a[1]});else if(t&&(a=this.rules.paragraph.exec(e)))e=e.substring(a[0].length),this.tokens.push({type:"paragraph",text:"\n"===a[1].charAt(a[1].length-1)?a[1].slice(0,-1):a[1]});else if(a=this.rules.text.exec(e))e=e.substring(a[0].length),this.tokens.push({type:"text",text:a[0]});else if(e)throw Error("Infinite loop on byte: "+e.charCodeAt(0));return this.tokens};var r={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:d,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,strong:/^__([^\s_])__(?!_)|^\*\*([^\s*])\*\*(?!\*)|^__([^\s][\s\S]*?[^\s])__(?!_)|^\*\*([^\s][\s\S]*?[^\s])\*\*(?!\*)/,em:/^_([^\s_])_(?!_)|^\*([^\s*<\[])\*(?!\*)|^_([^\s<][\s\S]*?[^\s_])_(?!_|[^\spunctuation])|^_([^\s_<][\s\S]*?[^\s])_(?!_|[^\spunctuation])|^\*([^\s<"][\s\S]*?[^\s\*])\*(?!\*|[^\spunctuation])|^\*([^\s*"<\[][\s\S]*?[^\s])\*(?!\*)/,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:d,text:/^(`+|[^`])(?:[\s\S]*?(?:(?=[\\<!\[`*]|\b_|$)|[^ ](?= {2,}\n))|(?= {2,}\n))/};function p(e,t){if(this.options=t||v.defaults,this.links=e,this.rules=r.normal,this.renderer=this.options.renderer||new n,this.renderer.options=this.options,!this.links)throw Error("Tokens array requires a `links` property.");this.options.pedantic?this.rules=r.pedantic:this.options.gfm&&(this.rules=this.options.breaks?r.breaks:r.gfm)}function n(e){this.options=e||v.defaults}function a(){}function u(e){this.tokens=[],this.token=null,this.options=e||v.defaults,this.options.renderer=this.options.renderer||new n,this.renderer=this.options.renderer,this.renderer.options=this.options,this.slugger=new t}function t(){this.seen={}}function b(e,t){if(t){if(b.escapeTest.test(e))return e.replace(b.escapeReplace,function(e){return b.replacements[e]})}else if(b.escapeTestNoEncode.test(e))return e.replace(b.escapeReplaceNoEncode,function(e){return b.replacements[e]});return e}function f(e){return e.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,function(e,t){return"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""})}function o(r,e){return r=r.source||r,e=e||"",{replace:function(e,t){return t=(t=t.source||t).replace(/(^|[^\[])\^/g,"$1"),r=r.replace(e,t),this},getRegex:function(){return RegExp(r,e)}}}function i(e,t,r){if(e){try{var n=decodeURIComponent(f(r)).replace(/[^\w:]/g,"").toLowerCase()}catch(e){return null}if(0==n.indexOf("javascript:")||0==n.indexOf("vbscript:")||0==n.indexOf("data:"))return null}t&&!l.test(r)&&(r=function(e,t){s[" "+e]||(s[" "+e]=/^[^:]+:\/*[^/]*$/.test(e)?e+"/":w(e,"/",!0));return e=s[" "+e],"//"===t.slice(0,2)?e.replace(/:[\s\S]*/,":")+t:"/"===t.charAt(0)?e.replace(/(:\/*[^/]*)[\s\S]*/,"$1")+t:e+t}(t,r));try{r=encodeURI(r).replace(/%25/g,"%")}catch(e){return null}return r}r._punctuation="!\"#$%&'()*+,\\-./:;<=>?@\\[^_{|}~",r.em=o(r.em).replace(/punctuation/g,r._punctuation).getRegex(),r._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,r._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,r._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,r.autolink=o(r.autolink).replace("scheme",r._scheme).replace("email",r._email).getRegex(),r._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,r.tag=o(r.tag).replace("comment",x._comment).replace("attribute",r._attribute).getRegex(),r._label=/(?:\[[^\[\]]*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,r._href=/<(?:\\[<>]?|[^\s<>\\])*>|[^\s\x00-\x1f]*/,r._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,r.link=o(r.link).replace("label",r._label).replace("href",r._href).replace("title",r._title).getRegex(),r.reflink=o(r.reflink).replace("label",r._label).getRegex(),r.normal=h({},r),r.pedantic=h({},r.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/,link:o(/^!?\[(label)\]\((.*?)\)/).replace("label",r._label).getRegex(),reflink:o(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",r._label).getRegex()}),r.gfm=h({},r.normal,{escape:o(r.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^~+(?=\S)([\s\S]*?\S)~+/,text:/^(`+|[^`])(?:[\s\S]*?(?:(?=[\\<!\[`*~]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@))|(?= {2,}\n|[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@))/}),r.gfm.url=o(r.gfm.url,"i").replace("email",r.gfm._extended_email).getRegex(),r.breaks=h({},r.gfm,{br:o(r.br).replace("{2,}","*").getRegex(),text:o(r.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()}),p.rules=r,p.output=function(e,t,r){return new p(t,r).output(e)},p.prototype.output=function(e){for(var t,r,n,a,o,i,s="";e;)if(o=this.rules.escape.exec(e))e=e.substring(o[0].length),s+=b(o[1]);else if(o=this.rules.tag.exec(e))!this.inLink&&/^<a /i.test(o[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(o[0])&&(this.inLink=!1),!this.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(o[0])?this.inRawBlock=!0:this.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(o[0])&&(this.inRawBlock=!1),e=e.substring(o[0].length),s+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(o[0]):b(o[0]):o[0];else if(o=this.rules.link.exec(e)){var c=m(o[2],"()");if(-1<c){var u=4+o[1].length+c;o[2]=o[2].substring(0,c),o[0]=o[0].substring(0,u).trim(),o[3]=""}e=e.substring(o[0].length),this.inLink=!0,n=o[2],a=this.options.pedantic?(t=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(n))?(n=t[1],t[3]):"":o[3]?o[3].slice(1,-1):"",n=n.trim().replace(/^<([\s\S]*)>$/,"$1"),s+=this.outputLink(o,{href:p.escapes(n),title:p.escapes(a)}),this.inLink=!1}else if((o=this.rules.reflink.exec(e))||(o=this.rules.nolink.exec(e))){if(e=e.substring(o[0].length),t=(o[2]||o[1]).replace(/\s+/g," "),!(t=this.links[t.toLowerCase()])||!t.href){s+=o[0].charAt(0),e=o[0].substring(1)+e;continue}this.inLink=!0,s+=this.outputLink(o,t),this.inLink=!1}else if(o=this.rules.strong.exec(e))e=e.substring(o[0].length),s+=this.renderer.strong(this.output(o[4]||o[3]||o[2]||o[1]));else if(o=this.rules.em.exec(e))e=e.substring(o[0].length),s+=this.renderer.em(this.output(o[6]||o[5]||o[4]||o[3]||o[2]||o[1]));else if(o=this.rules.code.exec(e))e=e.substring(o[0].length),s+=this.renderer.codespan(b(o[2].trim(),!0));else if(o=this.rules.br.exec(e))e=e.substring(o[0].length),s+=this.renderer.br();else if(o=this.rules.del.exec(e))e=e.substring(o[0].length),s+=this.renderer.del(this.output(o[1]));else if(o=this.rules.autolink.exec(e))e=e.substring(o[0].length),n="@"===o[2]?"mailto:"+(r=b(this.mangle(o[1]))):r=b(o[1]),s+=this.renderer.link(n,null,r);else if(this.inLink||!(o=this.rules.url.exec(e))){if(o=this.rules.text.exec(e))e=e.substring(o[0].length),s+=this.renderer.text(this.inRawBlock?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(o[0]):b(o[0]):o[0]:b(this.smartypants(o[0])));else if(e)throw Error("Infinite loop on byte: "+e.charCodeAt(0))}else{if("@"===o[2])n="mailto:"+(r=b(o[0]));else{for(;o[0]=this.rules._backpedal.exec(i=o[0])[0],i!==o[0];);r=b(o[0]),n="www."===o[1]?"http://"+r:r}e=e.substring(o[0].length),s+=this.renderer.link(n,null,r)}return s},p.escapes=function(e){return e?e.replace(p.rules._escapes,"$1"):e},p.prototype.outputLink=function(e,t){var r=t.href,n=t.title?b(t.title):null;return"!"!==e[0].charAt(0)?this.renderer.link(r,n,this.output(e[1])):this.renderer.image(r,n,b(e[1]))},p.prototype.smartypants=function(e){return this.options.smartypants?e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):e},p.prototype.mangle=function(e){if(!this.options.mangle)return e;for(var t,r="",n=e.length,a=0;a<n;a++)t=e.charCodeAt(a),.5<Math.random()&&(t="x"+t.toString(16)),r+="&#"+t+";";return r},n.prototype.code=function(e,t,r){var n=(t||"").match(/\S*/)[0];if(this.options.highlight){var a=this.options.highlight(e,n);null!=a&&a!==e&&(r=!0,e=a)}return n?'<pre><code class="'+this.options.langPrefix+b(n,!0)+'">'+(r?e:b(e,!0))+"</code></pre>\n":"<pre><code>"+(r?e:b(e,!0))+"</code></pre>"},n.prototype.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},n.prototype.html=function(e){return e},n.prototype.heading=function(e,t,r,n){return this.options.headerIds?"<h"+t+' id="'+this.options.headerPrefix+n.slug(r)+'">'+e+"</h"+t+">\n":"<h"+t+">"+e+"</h"+t+">\n"},n.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},n.prototype.list=function(e,t,r){var n=t?"ol":"ul";return"<"+n+(t&&1!==r?' start="'+r+'"':"")+">\n"+e+"</"+n+">\n"},n.prototype.listitem=function(e){return"<li>"+e+"</li>\n"},n.prototype.checkbox=function(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},n.prototype.paragraph=function(e){return"<p>"+e+"</p>\n"},n.prototype.table=function(e,t){return t&&(t="<tbody>"+t+"</tbody>"),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"},n.prototype.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},n.prototype.tablecell=function(e,t){var r=t.header?"th":"td";return(t.align?"<"+r+' align="'+t.align+'">':"<"+r+">")+e+"</"+r+">\n"},n.prototype.strong=function(e){return"<strong>"+e+"</strong>"},n.prototype.em=function(e){return"<em>"+e+"</em>"},n.prototype.codespan=function(e){return"<code>"+e+"</code>"},n.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},n.prototype.del=function(e){return"<del>"+e+"</del>"},n.prototype.link=function(e,t,r){if(null===(e=i(this.options.sanitize,this.options.baseUrl,e)))return r;var n='<a href="'+b(e)+'"';return t&&(n+=' title="'+t+'"'),n+=">"+r+"</a>"},n.prototype.image=function(e,t,r){if(null===(e=i(this.options.sanitize,this.options.baseUrl,e)))return r;var n='<img src="'+e+'" alt="'+r+'"';return t&&(n+=' title="'+t+'"'),n+=this.options.xhtml?"/>":">"},n.prototype.text=function(e){return e},a.prototype.strong=a.prototype.em=a.prototype.codespan=a.prototype.del=a.prototype.text=function(e){return e},a.prototype.link=a.prototype.image=function(e,t,r){return""+r},a.prototype.br=function(){return""},u.parse=function(e,t){return new u(t).parse(e)},u.prototype.parse=function(e){this.inline=new p(e.links,this.options),this.inlineText=new p(e.links,h({},this.options,{renderer:new a})),this.tokens=e.reverse();for(var t="";this.next();)t+=this.tok();return t},u.prototype.next=function(){return this.token=this.tokens.pop(),this.token},u.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},u.prototype.parseText=function(){for(var e=this.token.text;"text"===this.peek().type;)e+="\n"+this.next().text;return this.inline.output(e)},u.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,f(this.inlineText.output(this.token.text)),this.slugger);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var e,t,r,n,a="",o="";for(r="",e=0;e<this.token.header.length;e++)r+=this.renderer.tablecell(this.inline.output(this.token.header[e]),{header:!0,align:this.token.align[e]});for(a+=this.renderer.tablerow(r),e=0;e<this.token.cells.length;e++){for(t=this.token.cells[e],r="",n=0;n<t.length;n++)r+=this.renderer.tablecell(this.inline.output(t[n]),{header:!1,align:this.token.align[n]});o+=this.renderer.tablerow(r)}return this.renderer.table(a,o);case"blockquote_start":for(o="";"blockquote_end"!==this.next().type;)o+=this.tok();return this.renderer.blockquote(o);case"list_start":o="";for(var i=this.token.ordered,s=this.token.start;"list_end"!==this.next().type;)o+=this.tok();return this.renderer.list(o,i,s);case"list_item_start":o="";var c=this.token.loose,u=this.token.checked,p=this.token.task;for(this.token.task&&(o+=this.renderer.checkbox(u));"list_item_end"!==this.next().type;)o+=c||"text"!==this.token.type?this.tok():this.parseText();return this.renderer.listitem(o,p,u);case"html":return this.renderer.html(this.token.text);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText());default:var l='Token with "'+this.token.type+'" type was not found.';if(!this.options.silent)throw Error(l);console.log(l)}},t.prototype.slug=function(e){var t=e.toLowerCase().trim().replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-");if(this.seen.hasOwnProperty(t))for(var r=t;this.seen[r]++,this.seen.hasOwnProperty(t=r+"-"+this.seen[r]););return this.seen[t]=0,t},b.escapeTest=/[&<>"']/,b.escapeReplace=/[&<>"']/g,b.replacements={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},b.escapeTestNoEncode=/[<>"']|&(?!#?\w+;)/,b.escapeReplaceNoEncode=/[<>"']|&(?!#?\w+;)/g;var s={},l=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function d(){}function h(e){for(var t,r,n=1;n<arguments.length;n++)for(r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}function _(e,t){var r=e.replace(/\|/g,function(e,t,r){for(var n=!1,a=t;0<=--a&&"\\"===r[a];)n=!n;return n?"|":" |"}).split(/ \|/),n=0;if(t<r.length)r.splice(t);else for(;r.length<t;)r.push("");for(;n<r.length;n++)r[n]=r[n].trim().replace(/\\\|/g,"|");return r}function w(e,t,r){if(0===e.length)return"";for(var n=0;n<e.length;){var a=e.charAt(e.length-n-1);if(a!==t||r){if(a===t||!r)break;n++}else n++}return e.substr(0,e.length-n)}function m(e,t){if(-1==e.indexOf(t[1]))return-1;for(var r=0,n=0;n<e.length;n++)if("\\"===e[n])n++;else if(e[n]===t[0])r++;else if(e[n]===t[1]&&--r<0)return n;return-1}function g(e){e&&e.sanitize&&!e.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function v(e,r,n){if(null==e)throw Error("marked(): input parameter is undefined or null");if("string"!=typeof e)throw Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if(n||"function"==typeof r){n||(n=r,r=null),g(r=h({},v.defaults,r||{}));var a,o,i=r.highlight,t=0;try{a=c.lex(e,r)}catch(e){return n(e)}o=a.length;var s=function(t){if(t)return r.highlight=i,n(t);var e;try{e=u.parse(a,r)}catch(e){t=e}return r.highlight=i,t?n(t):n(null,e)};if(!i||i.length<3)return s();if(delete r.highlight,!o)return s();for(;t<a.length;t++)!function(r){"code"!==r.type?--o||s():i(r.text,r.lang,function(e,t){return e?s(e):null==t||t===r.text?--o||s():(r.text=t,r.escaped=!0,void(--o||s()))})}(a[t])}else try{return r&&(r=h({},v.defaults,r)),g(r),u.parse(c.lex(e,r),r)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",(r||v.defaults).silent)return"<p>An error occurred:</p><pre>"+b(e.message+"",!0)+"</pre>";throw e}}d.exec=d,v.options=v.setOptions=function(e){return h(v.defaults,e),v},v.getDefaults=function(){return{baseUrl:null,breaks:!1,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:new n,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,xhtml:!1}},v.defaults=v.getDefaults(),v.Parser=u,v.parser=u.parse,v.Renderer=n,v.TextRenderer=a,v.Lexer=c,v.lexer=c.lex,v.InlineLexer=p,v.inlineLexer=p.output,v.Slugger=t,y.exports=v.parse=v}(ar||"undefined"!=typeof window&&window)})),Bn=new(function(e){var t,r;function n(){return e.apply(this,arguments)||this}(t=n).prototype=Object.create((r=e).prototype),(t.prototype.constructor=t).__proto__=r;var a=n.prototype;return a.listitem=function(e){return""+Vn+e},a.list=function(e,t,r){var n=r;return e.replace(Vn,function(){return t?n+++". ":"- "})},n}($n.Renderer)),Vn="%list-item%";function zn(e){var t=$n(e,{renderer:Bn});Gn||(Gn=new DOMParser);var r=Gn.parseFromString(t,"text/html").body;return r?(r.textContent||"").replace(/\n+$/,""):""}var Hn,Wn,Kn=Gr?zn:nt,Yn=function(e,t){return e.order-t.order},Zn={question:{type:"text"},checkbox_for_email:{type:"checkbox",meta:"confirm_subscription"},header:{type:"information"},skill:{type:"group_select"}},Jn=function(e){return e.map(function(e,t){var r={};return We("label",e)&&(r.label=e.label),We("checked",e)&&(r.checked=e.checked),r.value=t+"",We("skill_id",e)&&(r.value=e.skill_id+""),We("embedded_chat_hide_when_offline",e)&&(r.ticketFormDisabled=!!e.embedded_chat_hide_when_offline),We("queue_template",e)&&(r.queueTemplate=e.queue_template),r})},Qn=function(e){var i=!1,t={fields:e.fields.sort(Yn).map(function(e,t){var r={};if("facebookConnect"===e.type)return!(i=!0);e.id?r.name=e.id:-1==["header","information"].indexOf(e.type)&&(r.name=t+""),We("value",e)&&(r.value=e.value),We("label",e)&&(r.label=e.label),We("required",e)&&(r.required=e.required),"rating"===e.type&&(r.commentLabel=e.options[0]),e.skills&&0<e.skills.length?r.options=Jn(e.skills):e.options&&0<e.options.length&&(r.options=e.options_data?Jn(e.options_data):Ye(e.options[0])?e.options.map(function(e,t){return{label:e.label,value:t+""}}):e.options.map(function(e,t){return{label:e,value:t+""}})),e.serverType&&(r.serverType=e.serverType);var n,a={type:Zn[n=e.type]&&Zn[n].type||n,meta:Zn[n]&&Zn[n].meta||!1},o=a.meta;return r.type=a.type,o&&(r.meta=o),r}).filter(Boolean)};return e.id&&(t.id=e.id),i&&(t.facebookConnect=!0),t},Xn=function(e){return vt({},e,{fields:e.fields.map(function(e){switch(e.type){case"name":case"subject":return vt({},e,{maxLength:1024});case"email":case"textarea":return vt({},e,{required:!0});default:return e}})})},ea=function(i,t,s){var e={survey_id:t.id},r=["name","question","email","checkbox","checkbox_for_email","radio","skill","select","textarea"],n=t.fields.map(function(n,e){var r,a,o={id:n.name,order:t.facebookConnect?e+1:e,type:(r=n.type,a=n.meta,void 0===a&&(a=!1),rt(function(e){var t=e.meta;return e.type===r&&(!t||a===t)},Zn)||r)};return"checkbox_for_email"===o.type?o.label="":We("label",n)&&(o.label=Kn(n.label)),We("options",n)?o.answers=n.options.map(function(e,t){var r={index:t};return We("label",e)&&(r.label=e.label),"skill"===o.type&&(r.group_id=parseInt(e.value,10)),r.chosen="group_select"===n.type?parseInt(s,10)===t:i[n.name]&&(Array.isArray(i[n.name])&&-1!=i[n.name].indexOf(e.value)||"string"==typeof i[n.name]&&i[n.name]===e.value)||!1,r}):o.answer=i[n.name]||"",o}).filter(function(e){return-1!=r.indexOf(e.type)});return e.fields=n,e},ta="function"==typeof fetch?fetch:function(a,o){return o=o||{},new Promise(function(e,t){var r=new XMLHttpRequest;for(var n in r.open(o.method||"get",a),o.headers)r.setRequestHeader(n,o.headers[n]);function s(){var n,a=[],o=[],i={};return r.getAllResponseHeaders().replace(/^(.*?):\s*([\s\S]*?)$/gm,function(e,t,r){a.push(t=t.toLowerCase()),o.push([t,r]),i[t]=(n=i[t])?n+","+r:r}),{ok:1==(r.status/200|0),status:r.status,statusText:r.statusText,url:r.responseURL,clone:s,text:function(){return Promise.resolve(r.responseText)},json:function(){return Promise.resolve(r.responseText).then(JSON.parse)},xml:function(){return Promise.resolve(r.responseXML)},blob:function(){return Promise.resolve(new Blob([r.response]))},headers:{keys:function(){return a},entries:function(){return o},get:function(e){return i[e.toLowerCase()]},has:function(e){return e.toLowerCase()in i}}}}r.withCredentials="include"==o.credentials,r.onload=function(){e(s())},r.onerror=t,r.send(o.body)})},ra="UPLOAD_FAILED",na=function(p,l,f){void 0===f&&(f={});var d=new XMLHttpRequest,r=new Promise(function(r,n){var t,a,o=f.headers,e=f.method,i=void 0===e?"POST":e,s=f.onProgress,c=f.withCredentials,u=void 0!==c&&c;"function"==typeof s&&(d.upload.onprogress=function(e){s(e.loaded/e.total)}),d.onload=function(){var e;try{e=JSON.parse(d.response)}catch(t){e=d.response}if(d.status<200||300<=d.status){var t=Error("Upload failed.");t.code=ra,t.response=e,n(t)}else r(e)},d.onerror=function(){var e=Error("Upload failed.");e.code=ra,n(e)},d.onabort=function(){var e=Error("Upload canceled.");e.code="UPLOAD_CANCELED",n(e)},d.open(i,p),d.withCredentials=u,o&&Object.keys(o).forEach(function(e){return d.setRequestHeader(e,o[e])}),d.send((t=l,a=new FormData,Object.keys(t).forEach(function(e){return a.append(e,t[e])}),a))});return{then:function(e,t){return r.then(e,t)},catch:function(e){return r.catch(e)},cancel:function(){d.abort()}}},aa="production",oa="staging",ia="labs",sa=((Hn={})[ia]="-labs.",Hn[oa]="-lc.",Hn[aa]=".",Hn),ca=((Wn={})[ia]="labs.",Wn[oa]="staging.",Wn[aa]="",Wn),ua=function(e,t,r){var n=t;return 1520===r&&(n=oa),"https://secure"+(e?"-"+e:"")+sa[n]+"livechatinc.com"},pa=function(e,t,r){var n=t;return 1520===r&&(n=oa),"https://api"+(e?"-"+e:"")+"."+ca[n]+"livechatinc.com"},la=function(e,o,t){void 0===t&&(t={});var i=t.attempts||3,s=t.retryDelay||1e3;return new Promise(function(n,a){!function t(){var r;ta(e,o).then(function(e){if(400!==e.status&&422!==e.status){if(!e.ok)throw Error({type:"connection",reason:"Request failed"});n(e)}else e.json().then(a).catch(a)}).catch(function(e){return i?(--i,setTimeout(function(){t()},s)):a(e)}),(r=15e3,new Promise(function(e){setTimeout(e,r)})).then(function(){a({type:"connection",reason:"Request timeout"})})}()})},fa=function(e){var t=e.license,r=e.token,n=e.file,a=e.chatId,o=e.onProgress,i=pa(e.region,e.environment,t)+"/v2/chats/"+a+"/attachment",s=na(i,{"author[type]":"visitor",license_id:t,files:n,token:r},{onProgress:o});return s[w]=s.cancel,s},da=function(e,t,r){var n=t.body,a=pa(t.region,t.environment,t.license)+"/"+e;return la(a,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(n)},r).then(function(e){return e.json()})},ha=function(e,t){var r=""+ua(t.region,t.environment,t.license)+e;return la(r,{method:"GET",headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()})},ma=function(e,t,r,n){return!1===t?"licence/g"+e+"_"+n:r?"licence/external/"+e:"licence/"+e},ga=function(e,t,r){var n=t.environment,a=t.license,o=t.body,i=void 0===o?{}:o,s=t.securedToken,c=t.secretId,u=t.region,p=t.queryStringData,l=void 0===p?{}:p,f=t.external,d=t.chatBetweenGroups,h=t.group,m=!0===st(e,t.requestDistribution)||-1!=e.indexOf("get_static_config")?"v2/":"",g={};s&&(g.secret_token=s),c&&(g.secret_id=c);var v=ua(u,n,a)+"/"+ma(a,d,f,h)+"/"+m+e+"?"+Br(vt({},l,g));return la(v,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(i)},r).then(function(e){return e.text()}).then(function(e){return JSON.parse(e.replace(/[\x01-\x08\x0B\x0C\x0E-\x1F\x7F]/g,""))})},va=function(e,t){var r=t.license,n=t.securedToken,a=t.secretId,o=t.external,i=t.group,s=t.chatBetweenGroups,c=ua(t.region,t.environment,r)+"/"+ma(r,s,o,i)+"/tunnel_callback.cgi?"+function(e){for(var t="",r="0123456789abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ",n=0;n<e;n++)t+=r.substr(Math.floor(64*Math.random()),1);return t}(20);return n&&(c+="&secret_token="+n),a&&(c+="&secret_id="+a),la(c+="&command="+encodeURIComponent(e),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}).then(function(e){return e.text()}).then(function(e){return e.split("^")})},ya=ir.mark(ba),xa=ir.mark(_a);function ba(t,r){var n,a,o;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ke(Jt.getPropertyChatBetweenGroups);case 2:return n=e.sent,e.next=5,ke(Jt.getPropertyGroup);case 5:return a=e.sent,"get_dynamic_config.js",e.t0=ye,e.t1=ga,e.t2="get_dynamic_config.js",e.t3=vt,e.t4={},e.t5=t,e.t6=r,e.next=16,Te("external");case 16:return e.t7=e.sent,e.t8={queryStringData:e.t6,external:e.t7},e.t9=(0,e.t3)(e.t4,e.t5,e.t8),e.next=21,(0,e.t0)(e.t1,e.t2,e.t9);case 21:if((o=e.sent).error&&"incorrect region"===o.error)return e.next=25,he(At.setPropertyRegion(o.region));e.next=40;break;case 25:return e.t10=ye,e.t11=ba,e.t12=vt,e.t13={},e.t14=t,e.t15=o.region,e.next=33,Te("external");case 33:return e.t16=e.sent,e.t17={region:e.t15,external:e.t16},e.t18=(0,e.t12)(e.t13,e.t14,e.t17),e.next=38,(0,e.t10)(e.t11,e.t18);case 38:return e.abrupt("return",e.sent);case 40:if(!1===n&&o.visitor.groups!==a)return e.next=43,he(At.setPropertyGroup(o.visitor.groups));e.next=57;break;case 43:return e.t19=ye,e.t20=ba,e.t21=vt,e.t22={},e.t23=t,e.next=50,Te("external");case 50:return e.t24=e.sent,e.t25={external:e.t24},e.t26=(0,e.t21)(e.t22,e.t23,e.t25),e.next=55,(0,e.t19)(e.t20,e.t26);case 55:return e.abrupt("return",e.sent);case 57:return e.abrupt("return",o);case 58:case"end":return e.stop()}},ya)}function _a(){var t,r,n,a,o,i,s;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ke(Jt.getPropertyLicense);case 2:return t=e.sent,e.next=5,ke(Jt.getPropertyGroup);case 5:return r=e.sent,e.next=8,ke(Qt);case 8:return n=e.sent,e.next=11,ke(Jt.getPropertyRegion);case 11:return a=e.sent,e.next=14,ke(er);case 14:return o=e.sent,e.next=17,ke(Jt.getPropertyChatBetweenGroups);case 17:return i=e.sent,s={},o.pageUrl&&(s.url=o.pageUrl),void 0!==r&&(s.groups=r),e.next=23,ye(ba,{environment:n,license:t,group:r,region:a,chatBetweenGroups:i},s);case 23:return e.abrupt("return",e.sent);case 24:case"end":return e.stop()}},xa)}var wa,ka=function(e){return"1"===e},Ia=function(e){return e.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&#94;/g,"^").replace(/&#45;/g,"-").replace(/&amp;/g,"&").replace(/<BR>/g,"\n")},Ta=Ia,Ea=function(e){return JSON.parse(Ia(e))},Sa=((wa={}).none="0",wa.bad="1",wa.good="2",wa),Pa={NEW_AGENT:"newAgent",NEW_AGENT_MESSAGE:"newAgentMessage",CHAT_ENDED:"chatEnded",VISITOR_QUEUED:"visitorQueued",TYPING_INDICATOR:"typingIndicator",RATE_CHAT:"rateChat",FORWARD_CHAT_TRANSCRIPT:"forwardChatTranscript",AGENTS_OFFLINE:"agentsOffline",GET_FORM:"getForm",GET_CUSTOM_FORM:"getCustomForm",JSON:"JSON",INTEGRATION_DATA:"integrationData"},Ca={IWCS5012F:[Pa.AGENTS_OFFLINE,{}],IWCS5011F:[Pa.AGENTS_OFFLINE,{}],IWCS0002R:[Pa.NEW_AGENT,{1:["id"],2:["name",Ia],12:["chatId"],23:["avatarUrl",Ia],25:["jobTitle",Ia]},function(e){return e&&{trigger:e.trigger}}],IWCS0006R:[Pa.NEW_AGENT_MESSAGE,{1:["authorId"],2:["message",Ta],9:["isMobile",ka],10:["id"],11:["json",function(e){if(!e)return null;try{return Ea(e)}catch(e){return null}}]}],IWCS1007S:[Pa.CHAT_ENDED,null,{reason:"closed"}],IWCS0093R:[Pa.CHAT_ENDED,null,{reason:"inactivity"}],IWCS0003R:[Pa.CHAT_ENDED,null,{reason:"closed_by_agent"}],IWCS1002S:[Pa.VISITOR_QUEUED,{2:["numberInQueue",parseInt],3:["waitingTime",parseInt]}],IWCS0002P:[Pa.TYPING_INDICATOR,{2:["realCommand",function(e){var t=e.split("&#45;");return{authorId:t[1],isTyping:ka(t[2])}}]}],IWCS0113C:[Pa.RATE_CHAT,{1:["visitorId"],2:["chatId"],3:["rate",function(t){return tt(function(e){return Sa[e]===t},Object.keys(Sa))},function(e){return Sa[e]}]}],IWCS0069C:[Pa.FORWARD_CHAT_TRANSCRIPT,{1:["visitorId"],2:["email"],5:["chatId"]}],IWCS0121C:[Pa.GET_FORM,{1:["type",null,function(){return"1"}],2:["license"],4:["group"]}],IWCS0122C:[Pa.GET_CUSTOM_FORM,{1:["license"],2:["type"],3:["group"]}],IWCSJSON:[Pa.JSON,{1:["json",Ea]}],IWCS0109R:[Pa.INTEGRATION_DATA,{1:["integrationName"],2:["data",Ea]}]},Aa=function(e,t){var r=e.split("^"),n=r[0],a=r.slice(1),o=Ca[n];if(!o)return null;var s=o[1],i=o[2];return{name:o[0],data:vt({},a.reduce(function(e,t,r){if(!s||!s[r+1])return e;var n=s[r+1],a=n[0],o=n[1],i=void 0===o?nt:o;return"realCommand"===a?vt({},e,i(t)):(e[a]=i(t),e)},{}),"function"==typeof i?i(t):i)}},Oa=function(t,e){for(var r,n=rt(function(e){return e[0]===t},Ca),a=Ca[n][1],o=Math.max.apply(Math,Object.keys(a)),i=[n];i.length<o+1;){var s=a[i.length];if(s){var c=(r=e[s[0]]+"",r.replace(/[\x01-\x08\x0B\x0C\x0E-\x1F\x7F]/g,"")).replace(/\^/g,"&#94;");i.push(s[2]?s[2](c):c)}else i.push("")}return i.join("^")+"^"},Na=ir.mark(Da),Ra=ir.mark(Ua),ja=ir.mark(Ga),La=ir.mark(Fa),Ma=ir.mark(qa);function Da(){return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me({license:ke(Jt.getPropertyLicense),securedToken:ke(Jt.getPropertySecuredToken),secretId:ke(Jt.getPropertySecretId),environment:ke(Qt),region:ke(Jt.getPropertyRegion),external:Te("external"),group:ke(Jt.getPropertyGroup),chatBetweenGroups:ke(Jt.getPropertyChatBetweenGroups),requestDistribution:ke(Jt.getPropertyRequestDistribution)});case 2:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},Na)}function Ua(t,r,n){var a;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n={}),e.next=3,ye(Da);case 3:return a=e.sent,e.next=6,ye(ga,t,vt({},a,{body:r}),n);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},Ra)}function Ga(t){var r;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye(Da);case 2:return r=e.sent,e.next=5,ye(ha,t,r);case 5:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},ja)}function Fa(t,r){var n,a;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Oa(t,r),e.next=3,ye(Da);case 3:return a=e.sent,e.next=6,ye(va,n,a);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},La)}function qa(t,r){var n,a,o,i;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye(Da);case 2:return a=(n=e.sent).license,o=n.environment,i=n.region,e.next=6,ye(da,t,{environment:o,region:i,license:a,body:r});case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},Ma)}var $a=ir.mark(Ba);function Ba(t,r){var n;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={},e.next=3,ye(Ua,"get_static_config."+t+"."+r+".js",n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},$a)}var Va=ir.mark(eo),za=ir.mark(no),Ha=ir.mark(ao),Wa=ir.mark(oo),Ka=ir.mark(io),Ya=ir.mark(so),Za=ir.mark(co),Ja=ir.mark(uo),Qa=function(){return"labs"===process.env.LC_ENV?"fe12a5c9f0921963a03b77cae572aa44":"feade1d6c3f17748ae4c8d917a1e1068"},Xa=function(e){var t,r,n,a=e.license_properties,o=e.group_properties,i="1"===o.chat_window.custom_mobile_settings,s="3"===a.lc_version,c=s&&"1"===a.continuous_chat_widget_enabled,u={nonProfitLicense:"1"===a.non_profit,visitorData:pt(Qe,e.visitor),features:{helpDesk:{enabled:ct(!1,"properties.group."+Qa()+".forwardTicketFormToHelpdesk",e),licenseId:ct(null,"properties.license."+Qa()+".hdLicenseID",e)},fileSharing:{enabled:e.attachments.enable_for_visitors},agentAvatar:{enabled:e.chat_window.display_avatar,showWithMessage:e.chat_window.display_avatar&&"modern"!==st("group_properties.chat_window.new_theme.name",e)},continuousChat:{enabled:c},chatHistory:{enabled:c||s&&"1"===a.customer_history_enabled},rating:{enabled:e.chat_window.display_rating,position:"modern"===st("group_properties.chat_window.new_theme.name",e)?"bottom":"right"},emailTranscript:{enabled:e.chat_window.display_transcript_button},logo:{enabled:e.chat_window.logo.display,path:Yr(e.chat_window.logo.path)},facebookButton:{enabled:!!e.chat_window.social.facebook},twitterButton:{enabled:!!e.chat_window.social.twitter},googlePlusButton:{enabled:!!e.chat_window.social.plusone},offlineForm:{enabled:!e.embedded_chat.hide_when_offline},linksPreview:{enabled:"1"===o.links_unfurling},preChatForm:{enabled:e.pre_chat_survey&&e.pre_chat_survey.enabled||!1},preChatAfterGreeting:{enabled:"1"===o.pre_chat_survey_after_greeting},creditCardMasking:{enabled:e.mask_credit_cards},hideTrademark:{enabled:"1"===o.chat_window.hide_trademark},hideOnMobile:{enabled:"1"===o.chat_window.hide_on_mobile},hideOnInit:{enabled:"1"===o.chat_window.hide_on_init},disableSounds:{enabled:"1"===o.chat_window.disable_sounds},minimized:{enabled:"0"===o.chat_window.disable_minimized},mobileMinimized:{enabled:i?"0"===o.chat_window.mobile_disable_minimized:"0"===o.chat_window.disable_minimized}},buttons:e.buttons.map(function(e){return{id:e.id,type:e.type,onlineImage:Yr(e.online_value),offlineImage:Yr(e.offline_value)}}),theme:{color:e.chat_window.theme.color,name:e.chat_window.theme.name,minimized:o.chat_window.theme.minimized,mobileMinimized:i?o.chat_window.mobile_minimized_theme:o.chat_window.theme.minimized},newTheme:{name:o.chat_window.new_theme.name,iconTheme:"modern"===o.chat_window.new_theme.name?"modern":"smooth",agentMessageBackgroundColor:ct("#fffff","group_properties.chat_window.new_theme.agent_message_color_background",e),agentMessageColorText:ct("#424d57","group_properties.chat_window.new_theme.agent_message_color_text",e),backgroundColor:ct("#e9eef4","group_properties.chat_window.new_theme.background_color",e).toLowerCase(),minimizedColorBackground:ct("#ffffff","group_properties.chat_window.new_theme.minimized_color_background",e),minimizedColorIcon:ct("#4384F5","group_properties.chat_window.new_theme.minimized_color_icon",e),minimizedColorText:ct("#000000","group_properties.chat_window.new_theme.minimized_color_text",e),visitorMessageBackgroundColor:ct("#4384f5","group_properties.chat_window.new_theme.visitor_message_color_background",e),visitorMessageColorText:ct("#ffffff","group_properties.chat_window.new_theme.visitor_message_color_text",e),titlebarBackgroundColor:ct("#ffffff","group_properties.chat_window.new_theme.titlebar_background_color",e),titlebarText:ct("#424d57","group_properties.chat_window.new_theme.titlebar_text",e),systemMessageColor:ct("#424d57","group_properties.chat_window.new_theme.system_message_color",e),agentbarBackgroundColor:ct("#ffffff","group_properties.chat_window.new_theme.agentbar_background_color",e),agentbarText:ct("#424d57","group_properties.chat_window.new_theme.agentbar_text",e),ctaColor:ct("#427fe1","group_properties.chat_window.new_theme.cta_color",e),customJson:function(e){var t={};try{t=JSON.parse(e)}catch(e){}return t}(st("group_properties.chat_window.new_theme.custom_json",e))},domainWhitelist:e.domain_whitelist,widgetType:e.embedded_chat.enabled?"embedded":"popup",integrations:e.integrations,language:e.lang,groups:(t=e.skills,r=e.skills_online,n="id",t.map(function(e){return{id:e.id,status:-1!=r.indexOf(e.id)?"online":"offline",oldButtons:{onlineImage:Yr(e.chat_button.online_url),offlineImage:Yr(e.chat_button.offline_url)}}}).reduce(function(e,t){return e[t[n]]=t,e},{})),clientLimitExceeded:e.client_limit_exceeded,screenPosition:o.chat_window.screen_position,mobileScreenPosition:i?o.chat_window.mobile_screen_position:o.chat_window.screen_position};return u.features.facebookButton.enabled&&(u.features.facebookButton.path=e.chat_window.social.facebook),u.features.twitterButton.enabled&&(u.features.facebookButton.path=e.chat_window.social.twitter),u.features.googlePlusButton.enabled&&(u.features.facebookButton.path=e.chat_window.social.plusone),u};function eo(t){var r,n,a;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he(At.setPropertyTicketForm(Xn(Qn(t.offline_form))));case 2:return e.next=4,Te("external");case 4:if(r=e.sent,t.pre_chat_survey)return n=Qn(t.pre_chat_survey),e.next=9,he(At.setPropertyPreChatForm(n));e.next=9;break;case 9:return a=r?t.localization_url.replace("/licence/","/licence/external/"):t.localization_url,e.next=12,he(At.setPropertyTranslationsVersion(a));case 12:return e.next=14,he(At.setPropertyConfigLoaded(!0));case 14:case"end":return e.stop()}},Va)}var to={labs:"labs",staging:"staging",production:"prod"},ro=function(r,e){return Ze(function(e){if(!e)return!1;var t=parseFloat(e);return(1<=t||!r)&&t>Math.random()},ot(e.split(",").map(function(e){return e.split(":")})))};function no(t){var r,n;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ke(Qt);case 2:return r=ro(!1===t.t,t.global_properties[to[e.sent]].requests_distribution),e.next=9,he(At.setPropertyRequestDistribution(r));case 9:return n=Xa(t),e.next=12,ke(Jt.getPropertyGroup);case 12:if(-1!=t.skills_online.indexOf(e.sent))return e.next=16,he(At.setPropertyChatStatus("ONLINE"));e.next=18;break;case 16:e.next=20;break;case 18:return e.next=20,he(At.setPropertyChatStatus("OFFLINE"));case 20:return e.next=22,he(At.setPropertyConfig(n));case 22:if("3"===t.license_properties.lc_version)return e.next=25,he(Wt());e.next=25;break;case 25:case"end":return e.stop()}},za)}function ao(){var t,r,n,a;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye(Lr,Jt.getPropertyStaticConfigVersion);case 2:return t=e.sent,e.next=5,ke(Jt.getPropertyGroup);case 5:return r=e.sent,e.next=8,ye(Ba,r,t);case 8:return n=e.sent,e.next=11,ye(eo,n);case 11:return e.next=13,ke(Jt.getPropertyDynamicConfig);case 13:return a=vt({},e.sent,n),e.next=17,ye(no,a);case 17:case"end":return e.stop()}},Ha)}function oo(){var t,r;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye(Lr,Jt.getPropertyTranslationsVersion);case 2:return t=e.sent,e.next=5,ye(Ga,t+"?acao=true");case 5:return r=pt(function(e){return e.toLowerCase()},e.sent.localization),e.next=9,he(At.setPropertyTranslations(r));case 9:case"end":return e.stop()}},Wa)}function io(t){var r,n,a,o;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ke(er);case 2:return r=e.sent,e.next=5,ke(Jt.getPropertyVisitorId);case 5:if(n=e.sent,a=vt({},r),void 0!==t.visitor.groups)return e.next=10,he(At.setPropertyGroup(t.visitor.groups));e.next=10;break;case 10:return e.next=12,he(At.setPropertyStaticConfigVersion(t.static_config_version));case 12:if((r.name||t.visitor.nick)&&(a.name=r.name||t.visitor.nick),(o=a.customProperties||t.visitor.params&&Vr(t.visitor.params))&&(a.customProperties=o),t.visitor.nick||t.visitor.params)return e.next=18,he(qt({visitorData:a}));e.next=18;break;case 18:if(n){e.next=22;break}return e.next=21,he(At.setPropertyVisitorId(t.visitor.session));case 21:$r.setItem("visitorId",t.visitor.session);case 22:case"end":return e.stop()}},Ka)}function so(t){var r,n,a;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye(io,t);case 2:return e.next=4,he(At.setPropertyDynamicConfig(t));case 4:return e.next=6,he(At.setPropertyClientLimitExceeded(t.client_limit_exceeded));case 6:if(t.automatic_greeting)return r=Zr(t.automatic_greeting),n=r.agent,a=r.invitation,e.next=10,he(jt(vt({},n,{fromInvitation:!0})));e.next=12;break;case 10:return e.next=12,he(zt(a));case 12:case"end":return e.stop()}},Ya)}function co(){var t,r,n;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye(_a);case 2:return r=(t=e.sent).static_config_version,n=t.visitor.groups,e.next=7,ye(Ba,n,r);case 7:if("3"===e.sent.license_properties.lc_version)return e.next=12,he(Wt());e.next=12;break;case 12:case"end":return e.stop()}},Za)}function uo(t){var r;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t)return e.next=3,ye(so,t);e.next=8;break;case 3:return e.next=5,ye(eo,t);case 5:return e.next=7,ye(no,t);case 7:return e.abrupt("return");case 8:return e.next=10,ye(_a);case 10:return r=e.sent,e.next=13,ye(so,r);case 13:return e.next=15,ye(ao);case 15:case"end":return e.stop()}},Ja)}var po="CHATTING",lo="NOT_CHATTING",fo=ir.mark(ho);function ho(t){var r,n,a,o;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.customId,n=t.text,a=t.json,e.next=3,ye(Lr,Jt.getPropertyVisitorId);case 3:return o={author:"visitor",message:n,message_id:r,random_id:r,visitor:{id:e.sent}},a&&(o.message_json=JSON.stringify(a)),e.next=8,ye(Ua,"send_message",o);case 8:return e.next=10,he({type:"PRIVATE_SEND_MESSAGE"});case 10:case"end":return e.stop()}},fo)}var mo=ir.mark(go);function go(){var t,r;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye(Lr,Jt.getPropertyVisitorId);case 2:return t=e.sent,r={source:"visitor",random_id:Math.random()+"",visitor:{id:t}},e.next=6,ye(Ua,"close_chat",r);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},mo)}var vo=ir.mark(yo);function yo(t){var r,n;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye(Lr,Jt.getPropertyVisitorId);case 2:return r=e.sent,e.next=5,ke(Jt.getPropertyChatId);case 5:return n={visitorId:r,chatId:e.sent,email:t.payload.email},e.next=9,ye(Fa,"forwardChatTranscript",n);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},vo)}var xo=ir.mark(bo);function bo(t){var r,n;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye(Lr,Jt.getPropertyVisitorId);case 2:return r=e.sent,e.next=5,ke(Jt.getPropertyChatId);case 5:return n={visitorId:r,chatId:e.sent,rate:t.payload.rate},e.next=9,ye(Fa,"rateChat",n);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},xo)}var _o=ir.mark(Eo),wo=Gr?zn:nt,ko=function(e,t){var n=pt(function(e){return"message"===e?"textarea":e},e);return t.fields.map(function(e){if("information"===e.type)return null;var t,r={type:e.type,text:wo(e.label),serverType:e.serverType};return(e.name in n||e.type in n)&&(r.value="options"in e?(t=n[e.name],Ke(t)?t:[t]).map(function(t){return tt(function(e){return e.value===t},e.options).label}).join(", "):e.name in n?n[e.name]:n[e.type],r.value=r.value.replace(bt,""),r.text=r.text+" "+r.value),r}).filter(Boolean)},Io=function(e,t,r){var n=e.group,a=e.license,o=e.visitorId,i=e.visitorData,s=e.defaultValues,c=ko(r,t),u=tt(function(e){return"email"===e.type||"email"===e.serverType},c);if(!u)throw{type:"missing argument",reason:"Missing email"};if(!tt(function(e){return"textarea"===e.type},c))throw{type:"missing argument",reason:"Missing message"};var p=tt(function(e){return"name"===e.type||"name"===e.serverType},c),l=tt(function(e){return"subject"===e.type||"subject"===e.serverType},c),f=c.filter(function(e){return-1==["name","email","subject"].indexOf(e.serverType||e.type)}).map(function(e){return e.text}).join("\n"),d={mail:u.value};p?d.name=p.value:s&&s.name&&(d.name=s.name);var h={group:n,licence_id:a,ticket_message:f,offline_message:c.map(function(e){return e.text}).join("\n"),requester:d,visitor_id:o};return l&&l.value&&(h.subject=l.value),i.pageUrl&&(h.source={url:i.pageUrl}),h},To=function(e,t){var r={id:e,text:t.ticket_message,visitor:{name:t.requester.name||null,email:t.requester.mail||null}};return t.subject&&(r.subject=t.subject),r};function Eo(t){var r,n,a,o,i,s,c,u,p,l;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ke(Jt.getPropertyGroup);case 2:return r=e.sent,e.next=5,ke(Jt.getPropertyLicense);case 5:return n=e.sent,e.next=8,ye(Lr,Jt.getPropertyVisitorId);case 8:return a=e.sent,e.next=11,ke(er);case 11:return o=e.sent,e.next=14,ke(Jt.getPropertyTicketForm);case 14:return i=e.sent,e.next=17,ke(Jt.getPropertyTranslations);case 17:return c=Io({group:r,license:n,visitorId:a,visitorData:o,defaultValues:(s=e.sent)?{name:s.client}:{}},i,t.answers),e.next=22,ye(qa,"v2/tickets/new",c);case 22:if((u=e.sent).errors)throw{type:l=Object.keys(p=u.errors[0])[0],reason:p[l][0]};e.next=27;break;case 27:return e.abrupt("return",To(u.id,c));case 28:case"end":return e.stop()}},_o)}var So=ir.mark(Oo),Po=function(e,t){return la("https://api."+("labs"===e?"labs.":"")+"helpdesk.com/v1/externalTickets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){return{id:e.ID}})},Co=function(e,t,r,n){var a=ko(n,r),o=tt(function(e){return"email"===e.type||"email"===e.serverType},a),i=tt(function(e){return"name"===e.type||"name"===e.serverType},a);if(!o)throw Error("Missing email");if(!tt(function(e){return"textarea"===e.type},a))throw Error("Missing message");var s=tt(function(e){return"subject"===e.type||"subject"===e.serverType},a),c=a.filter(function(e){return-1==["name","email","subject"].indexOf(e.serverType||e.type)}).map(function(e){return e.text}).join("\n");return vt({},s&&s.value&&{subject:s.value},{message:{text:c},requester:vt({email:o.value},i&&i.value&&{name:i.value}),integration:{type:"livechat",ID:e+"",teamID:t+""}})},Ao=function(e,t){var r=t.requester,n=t.subject;return vt({id:e,text:t.message.text},n&&{subject:n},{visitor:{name:r.name||null,email:r.email||null}})};function Oo(t){var r,n,a,o;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ke(Jt.getPropertyTicketForm);case 2:return r=e.sent,e.next=5,ke(Jt.getPropertyGroup);case 5:return n=e.sent,e.next=8,ke(Jt.getPropertyLicense);case 8:return a=Co(e.sent,n,r,t.answers),e.next=12,ke(Qt);case 12:return o=e.sent,e.next=15,ye(Po,o,a);case 15:return e.abrupt("return",Ao(e.sent.id,a));case 17:case"end":return e.stop()}},So)}var No=ir.mark(Ro);function Ro(t){var r;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ke(Jt.getPropertyLicense);case 2:return r={license:e.sent,type:"offline",group:t},e.next=6,ye(Fa,"getCustomForm",r);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},No)}var jo=ir.mark(Lo);function Lo(){var t,r;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ke(Jt.getPropertyLicense);case 2:return t=e.sent,e.next=5,ke(Jt.getPropertyGroup);case 5:return r={license:t,type:"queued",group:e.sent},e.next=9,ye(Fa,"getCustomForm",r);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},jo)}var Mo=ir.mark(Do);function Do(t){var r,n;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye(Lr,Jt.getPropertyVisitorId);case 2:return r=e.sent,e.next=5,ke(Jt.getPropertyChatId);case 5:return n={comment:t.payload.comment,conference_id:e.sent,random_id:Math.random()+"",visitor:{id:r}},e.next=9,ye(Ua,"send_rating_comment",n);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},Mo)}var Uo=ir.mark(Go);function Go(t){var r,n,a;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye(Lr,Jt.getPropertyVisitorId);case 2:return r=e.sent,n=t.customId,e.next=6,ye(Lr,Jt.getPropertyChatId);case 6:return a={random_id:n,conference_id:e.sent,visitor:{id:r},valid_time_sec:60},e.next=10,ye(Ua,"attachment_token",a);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},Uo)}var Fo=ir.mark(qo);function qo(){var t,r;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ke(Jt.getPropertyLicense);case 2:return t=e.sent,e.next=5,ke(Jt.getPropertyGroup);case 5:return r={type:"postchat",license:t,group:e.sent},e.next=9,ye(Fa,"getForm",r);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},Fo)}var $o=ir.mark(Bo);function Bo(t){var r,n,a;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.answers,e.next=3,ke(Jt.getPropertyVisitorId);case 3:return n=e.sent,e.next=6,ke(Jt.getPropertyChatId);case 6:return a={conference_id:e.sent,random_id:Math.random()+"",survey:r,visitor:{id:n}},e.next=10,ye(Ua,"post_chat_survey_data",a);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},$o)}var Vo=ir.mark(zo);function zo(){var t,r;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye(Lr,Jt.getPropertyVisitorId);case 2:return t=e.sent,r={random_id:Math.random()+"",visitor:{id:t}},e.next=6,ye(Ua,"get_predicted_agent",r);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},Vo)}var Ho=ir.mark(Wo);function Wo(t){var r,n,a,o;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.messageId,e.next=3,ye(Lr,Jt.getPropertyVisitorId);case 3:return n=e.sent,e.next=6,ke(Jt.getPropertyServerIdsMap);case 6:return o={message:{id:(a=e.sent[r]).serverId,agent_id:a.authorId},random_id:Math.random()+"",visitor:{id:n}},e.next=11,ye(Ua,"agent_message_seen",o);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}},Ho)}var Ko=ir.mark(Yo);function Yo(t){var r,n;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t){e.next=4;break}e.t0=t,e.next=7;break;case 4:return e.next=6,ke(Jt.getPropertyGroup);case 6:e.t0=e.sent;case 7:return r=e.t0,e.next=10,ye(Lr,Jt.getPropertyVisitorId);case 10:return n={visitor:{id:e.sent},skill:r,random_id:Math.random()+""},e.next=14,ye(Ua,"status_ping",n,{retry:10});case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}},Ko)}var Zo=function(e){return{chatState:e.visitor_is_chatting?po:lo,chatStatus:e.agent_available?"ONLINE":"OFFLINE"}},Jo=ir.mark(Qi),Qo=ir.mark(Xi),Xo=ir.mark(es),ei=ir.mark(ts),ti=ir.mark(rs),ri=ir.mark(ns),ni=ir.mark(as),ai=ir.mark(os),oi=ir.mark(is),ii=ir.mark(ss),si=ir.mark(cs),ci=ir.mark(us),ui=ir.mark(ps),pi=ir.mark(ls),li=ir.mark(fs),fi=ir.mark(ds),di=ir.mark(vs),hi=ir.mark(ys),mi=ir.mark(bs),gi=ir.mark(_s),vi=ir.mark(ws),yi=ir.mark(ks),xi=ir.mark(Is),bi=ir.mark(Ts),_i=ir.mark(Es),wi=ir.mark(Ss),ki=ir.mark(Ps),Ii=ir.mark(Cs),Ti=ir.mark(As),Ei=ir.mark(Os),Si=18e5,Pi=sr,Ci=cr,Ai=ur,Oi=pr,Ni=lr,Ri=fr,ji=dr,Li=hr,Mi=mr,Di=gr,Ui=vr,Gi=xr,Fi=br,qi=_r,$i=wr,Bi=kr,Vi=Ir,zi=Tr,Hi=Er,Wi=Sr,Ki=Pr,Yi=Cr,Zi=Ar,Ji=Or;function Qi(){var t;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ke(Jt.getPropertyTranslations);case 2:if(t=e.sent)return e.abrupt("return",t);e.next=5;break;case 5:return e.next=7,ye(oo);case 7:return e.next=9,ke(Jt.getPropertyTranslations);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},Jo)}function Xi(){var t;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ke(Jt.getPropertyWelcomeMessage);case 2:if(t=e.sent)return e.abrupt("return",t);e.next=5;break;case 5:return e.next=7,ye(Qi);case 7:return e.abrupt("return",e.sent.welcome_to_chat);case 8:case"end":return e.stop()}},Qo)}function es(t){var r,n,a,o,i,s,c,u,p,l;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u=function(){return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,de(function(e){return e.type===Nt.getActionName()&&st("payload.customId",e)===a});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},r)},r=ir.mark(u),e.next=4,ye(Lr,Jt.getPropertyChatState);case 4:return a=(n=t.payload).customId,o=n.text,i=n.json,s=e.sent!==po,e.next=9,ke(Jt.getPropertyAcceptedInvitation);case 9:return c=e.sent,e.next=12,xe(u);case 12:if(p=e.sent,e.prev=13,s)return e.t0=ye,e.t1=Rs,e.t2=a,e.t3=o,e.next=21,ye(Xi);e.next=28;break;case 21:return e.t4=e.sent,e.t5=c,e.t6={customId:e.t2,text:e.t3,welcomeMessage:e.t4,acceptedInvitation:e.t5},e.next=26,(0,e.t0)(e.t1,e.t6);case 26:e.next=30;break;case 28:return e.next=30,ye(ho,{customId:a,text:o,json:i});case 30:e.next=38;break;case 32:return e.prev=32,e.t7=e.catch(13),t.payload.promise.reject({type:"connection",reason:"Request failed"}),e.next=37,we(p);case 37:return e.abrupt("return");case 38:if(s)return e.next=41,de([jt.getActionName(),Rt.getActionName()]);e.next=45;break;case 41:if(e.sent.type===Rt.getActionName())return t.payload.promise.reject({type:"state",reason:"Chat is offline"}),e.abrupt("return");e.next=45;break;case 45:return e.next=47,_e(p);case 47:t.payload.promise.resolve({id:(l=e.sent).payload.id,timestamp:l.payload.timestamp});case 49:case"end":return e.stop()}},Xo,null,[[13,32]])}function ts(t){var r,n,a,o,i,s;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye(Lr,Jt.getPropertyClientLimitExceeded);case 2:return e.next=4,ke(er);case 4:return n=ht(["customProperties"],r=e.sent),a=mt(et,gt(["name","email","pageUrl","pageTitle","customProperties"],t.payload)),o=Math.random()+"",i=lt(t.payload.update?r:n,a),e.next=11,he(qt({requestId:o,visitorData:i}));case 11:return e.next=13,de(function(e){return(e.type===Lt.getActionName()||e.type===Mt.getActionName())&&e.payload.requestId===o});case 13:if((s=e.sent).type===Lt.getActionName())return e.abrupt("return",t.payload.promise.resolve(s.payload.visitorData));e.next=16;break;case 16:return e.abrupt("return",t.payload.promise.reject({type:"connection",reason:"Request failed"}));case 17:case"end":return e.stop()}},ei)}function rs(t){return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he(At.setPropertySneakPeek(t.payload.text));case 2:t.payload.promise.resolve({success:!0});case 3:case"end":return e.stop()}},ti)}function ns(t){return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ke(Jt.getPropertyChatId);case 2:if(e.sent){e.next=6;break}return t.payload.promise.reject({type:"state",reason:"There is no chat to forward transcript"}),e.abrupt("return");case 6:return e.prev=6,e.next=9,ye(yo,t);case 9:e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(6),t.payload.promise.reject({type:"connection",reason:"Request failed"}),e.abrupt("return");case 15:t.payload.promise.resolve({success:!0});case 16:case"end":return e.stop()}},ri,null,[[6,11]])}function as(t){return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ke(Jt.getPropertyChatId);case 2:if(e.sent){e.next=6;break}return t.payload.promise.reject({type:"state",reason:"There is no chat to close"}),e.abrupt("return");case 6:return e.prev=6,e.next=9,ye(go);case 9:e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(6),t.payload.promise.reject({type:"connection",reason:"Request failed"}),e.abrupt("return");case 15:return e.next=17,de(Rt.getActionName());case 17:t.payload.promise.resolve({success:!0});case 18:case"end":return e.stop()}},ni,null,[[6,11]])}function os(t){return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ke(Jt.getPropertyChatId);case 2:if(e.sent){e.next=6;break}return t.payload.promise.reject({type:"state",reason:"There is no chat to rate"}),e.abrupt("return");case 6:if(t.payload.rate)return e.prev=7,e.next=10,ye(bo,t);e.next=16;break;case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(7),t.payload.promise.reject({type:"connection",reason:"Request failed"}),e.abrupt("return");case 16:if(t.payload.comment)return e.prev=17,e.next=20,ye(Do,t);e.next=26;break;case 20:e.next=26;break;case 22:return e.prev=22,e.t1=e.catch(17),t.payload.promise.reject({type:"connection",reason:"Rate Comment request failed"}),e.abrupt("return");case 26:t.payload.promise.resolve({success:!0});case 27:case"end":return e.stop()}},ai,null,[[7,12],[17,22]])}function is(t){var r;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload,e.next=3,ke(Jt.getPropertyChatState);case 3:if(e.sent===po)return r.promise.reject({type:"state",reason:"You can't disconnect during the chat"}),e.abrupt("return");e.next=7;break;case 7:r.promise.resolve({success:!0});case 8:case"end":return e.stop()}},oi)}function ss(t){var r,n,a,o,i;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(r=t.payload).promise,void 0!==(a=r.group))return e.prev=3,e.next=6,ye(Ro,a);e.next=18;break;case 6:return o=Aa(e.sent.join("^")),i=Xn(Qn(o.data.json)),e.next=11,he(At.setPropertyTicketForm(i));case 11:n.resolve(i),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),n.reject({type:"connection",reason:"Request failed"});case 17:return e.abrupt("return");case 18:return e.next=20,ye(Lr,Jt.getPropertyTicketForm);case 20:n.resolve(e.sent);case 22:case"end":return e.stop()}},ii,null,[[3,14]])}function cs(t){var r,n;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload.promise,e.prev=2,e.next=5,ye(Lo);case 5:n=Aa(e.sent.join("^")),r.resolve(Qn(n.data.json)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),r.reject({type:"connection",reason:"Request failed"});case 13:case"end":return e.stop()}},si,null,[[2,10]])}function us(t){var r;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload,e.prev=1,e.next=4,ye(Qi);case 4:return e.abrupt("return",r.promise.resolve(e.sent));case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",r.promise.reject({type:"connection",reason:"Request failed"}));case 11:case"end":return e.stop()}},ci,null,[[1,8]])}function ps(t){var r;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload,e.next=3,ye(Lr,Jt.getPropertyVisitorId);case 3:return e.next=5,ke(er);case 5:return e.abrupt("return",r.promise.resolve(e.sent));case 7:case"end":return e.stop()}},ui)}function ls(t){var r,n,a;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload,e.next=3,ke(Jt.getPropertyConfig);case 3:return n=ct(!1,"features.helpDesk.enabled",e.sent),a=n?Oo:Eo,e.next=8,ye(Lr,Jt.getPropertyTicketForm);case 8:return e.prev=8,e.t0=r.promise,e.next=12,ye(a,r);case 12:e.t1=e.sent,e.t0.resolve.call(e.t0,e.t1),e.next=19;break;case 16:e.prev=16,e.t2=e.catch(8),r.promise.reject(e.t2&&e.t2.reason||e.t2&&e.t2.errors?e.t2:{type:"connection",reason:"Request failed"});case 19:case"end":return e.stop()}},pi,null,[[8,16]])}function fs(){var t;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye(Lr,Jt.getPropertyConfigLoaded);case 2:return e.next=4,ke(Jt.getPropertyPreChatForm);case 4:if(t=e.sent){e.next=7;break}return e.abrupt("return",null);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}},li)}function ds(t){var r,n;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload,e.prev=1,e.next=4,ye(fs);case 4:if(n=e.sent){e.next=7;break}return e.abrupt("return",r.promise.reject({type:"state",reason:"Pre-chat survey is turned off"}));case 7:return e.abrupt("return",r.promise.resolve(n));case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",r.promise.reject({type:"connection",reason:"Request failed"}));case 13:case"end":return e.stop()}},fi,null,[[1,10]])}var hs=["email","text","radio","select","group_select"],ms=["checkbox"],gs=function(e,n){return e.map(function(e){var t=n[e.name],r=typeof n[e.name];return e.required&&!t?{reason:"Required field",description:"Pease fill in required field",field:e.name}:t&&-1!=hs.indexOf(e.type)&&"string"!==r?{reason:"Wrong type",field:e.name}:!(!t||-1==ms.indexOf(e.type)||Array.isArray(t))&&{reason:"Wrong type",field:e.name}}).filter(Boolean)};function vs(t){var r,n,a,o,i,s,c,u,p,l,f,d,h;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload,e.next=3,ye(Lr,Jt.getPropertyChatState);case 3:if(n=e.sent,e.prev=4,n===po)return e.abrupt("return",r.promise.reject({type:"state",reason:"You can't send prechat when chat is running"}));e.next=7;break;case 7:return e.next=9,ke(er);case 9:return a=e.sent,e.next=12,ye(fs);case 12:return o=e.sent,s=r.promise,c=(i=r.answers).choosenGroupIndex,u=yt(i,["choosenGroupIndex"]),e.next=17,ke(Jt.getPropertyAcceptedInvitation);case 17:if(p=e.sent,l=ea(u,o,c),0!==(f=gs(o.fields,u)).length)return e.abrupt("return",s.reject({type:"wrong arguments",fields:f}));e.next=22;break;case 22:if(d=l.fields.filter(function(e){return"email"===e.type||"name"===e.type}))return h=d.reduce(function(e,t){var r;return vt({},e,((r={})[t.type]=t.answer,r))},a),e.next=27,he(qt({visitorData:h}));e.next=27;break;case 27:return e.t0=ye,e.t1=Rs,e.t2=l,e.next=32,ye(Xi);case 32:return e.t3=e.sent,e.t4=p,e.t5={customId:"prechat_startchat",answers:e.t2,welcomeMessage:e.t3,acceptedInvitation:e.t4},e.next=37,(0,e.t0)(e.t1,e.t5);case 37:return e.next=39,ye(Lr,Jt.getPropertyChatId);case 39:return e.abrupt("return",s.resolve({success:!0}));case 42:return e.prev=42,e.t6=e.catch(4),e.abrupt("return",r.promise.reject({type:"connection",reason:"Request failed"}));case 45:case"end":return e.stop()}},di,null,[[4,42]])}function ys(t){var r,n,a,o,i,s,c,u,p,l;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload,e.next=3,ye(Lr,Jt.getPropertyChatState);case 3:return n=e.sent,e.next=6,ke(Qt);case 6:return a=e.sent,e.next=9,ke(Jt.getPropertyLicense);case 9:return o=e.sent,e.next=12,ke(Jt.getPropertyRegion);case 12:if(i=e.sent,s=r.customId,c=r.file,u=r.onProgress,e.prev=14,n!==po)return e.next=18,ye(Rs,{customId:s+"_startchat",text:""});e.next=18;break;case 18:return e.next=20,ye(Lr,Jt.getPropertyChatId);case 20:return p=e.sent,e.next=23,ye(Go,r);case 23:return l=e.sent.attachment_token,e.next=27,ye(fa,{environment:a,region:i,license:o,token:l,file:c,chatId:p,onProgress:u});case 27:return e.next=29,de(function(e){return e.type===Dt.getActionName()&&e.payload.attachmentToken===l});case 29:return e.abrupt("return",r.promise.resolve(mt(et,gt(["id","timestamp","url","contentType","size","width","height"],e.sent.payload))));case 33:return e.prev=33,e.t0=e.catch(14),e.abrupt("return",r.promise.reject({type:"connection",reason:"Request failed"}));case 36:case"end":return e.stop()}},hi,null,[[14,33]])}var xs=function(e){var t=e.payload;return e.type===At.setPropertyPingSent.getActionName()&&!0===t.data};function bs(t){var r,n,a,o,i,s,c,u,p,l;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload,e.prev=1,e.next=4,ye(Lr,Jt.getPropertyClientLimitExceeded);case 4:if(e.sent)return e.next=8,de(xs);e.next=8;break;case 8:return e.next=10,ye(zo);case 10:if((n=e.sent).agent){e.next=13;break}return e.abrupt("return",r.promise.resolve({}));case 13:return e.next=15,ye(Qi);case 15:return o=(a=n.agent).login,i=a.name,s=a.avatar_url,c=a.job_title,u=a.is_bot,p=e.sent.welcome_to_chat,e.next=20,he(At.setPropertyWelcomeMessage(p));case 20:return l={name:i,isBot:u,jobTitle:c,id:o,avatarUrl:Yr(s),message:p},e.abrupt("return",r.promise.resolve(l));case 24:return e.prev=24,e.t0=e.catch(1),e.abrupt("return",r.promise.reject({type:"connection",reason:"Request failed"}));case 27:case"end":return e.stop()}},mi,null,[[1,24]])}function _s(t){var r,n,a;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload,e.prev=1,e.next=4,ye(qo);case 4:if((n=Ea(e.sent[1])).survey){e.next=8;break}return e.abrupt("return",r.promise.reject({type:"state",reason:"Post-chat survey is turned off"}));case 8:return a=Qn(n.survey),e.next=11,he(At.setPropertyPostChatForm(a));case 11:return e.abrupt("return",r.promise.resolve(a));case 14:return e.prev=14,e.t0=e.catch(1),e.abrupt("return",r.promise.reject({type:"connection",reason:"Request failed"}));case 17:case"end":return e.stop()}},gi,null,[[1,14]])}function ws(t){var r,n,a;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload,e.prev=1,n=r.answers,e.next=5,ke(Jt.getPropertyPostChatForm);case 5:return a=ea(n,e.sent),e.next=9,ye(Bo,{answers:a});case 9:return e.abrupt("return",r.promise.resolve({success:!0}));case 12:return e.prev=12,e.t0=e.catch(1),e.abrupt("return",r.promise.reject({type:"connection",reason:"Request failed"}));case 15:case"end":return e.stop()}},vi,null,[[1,12]])}function ks(t){var r;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload,e.next=3,ke(Jt.getPropertyConfig);case 3:if(e.sent){e.next=7;break}return e.next=7,ye(ao);case 7:return e.next=9,ke(Jt.getPropertyConfig);case 9:r.promise.resolve(e.sent);case 11:case"end":return e.stop()}},yi)}function Is(t){var r;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload,e.next=3,he(At.setPropertyAcceptedInvitation(r.id));case 3:r.promise.resolve({success:!0});case 4:case"end":return e.stop()}},xi)}function Ts(t){var r,n;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload,e.prev=1,n=r.messageId,e.next=5,ye(Wo,{messageId:n});case 5:return e.abrupt("return",r.promise.resolve({success:!0}));case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",r.promise.reject({type:"connection",reason:"Request failed"}));case 11:case"end":return e.stop()}},bi,null,[[1,8]])}function Es(t){var r,n;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload,e.next=3,ye(Lr,Jt.getPropertyChatState);case 3:if(e.sent===po)return r.promise.reject({type:"state",reason:"You can't start new chat during chat"}),e.abrupt("return");e.next=8;break;case 8:return e.next=10,ke(Jt.getPropertyWelcomeMessage);case 10:if(n=e.sent){e.next=15;break}return e.next=14,ye(Qi);case 14:n=e.sent.welcome_to_chat;case 15:return e.prev=15,e.next=18,ye(Rs,{customId:"startchat",welcomeMessage:n});case 18:return e.next=20,ye(Lr,Jt.getPropertyChatId);case 20:r.promise.resolve({chatId:e.sent}),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(15),r.promise.reject({type:"connection",reason:"Request failed"});case 27:case"end":return e.stop()}},_i,null,[[15,24]])}function Ss(t){var r,n,a,o,i,s,c,u,p;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=(r=t.payload).promise,void 0===(n=r.group)){e.next=6;break}e.t0=n,e.next=9;break;case 6:return e.next=8,ke(Jt.getPropertyGroup);case 8:e.t0=e.sent;case 9:return o=e.t0,e.next=12,ke(Jt.getPropertyClientLimitExceeded);case 12:if((i=e.sent)||void 0!==n){e.next=23;break}return e.next=16,ke(Jt.getPropertyChatState);case 16:return s=e.sent===po,e.next=20,ke(Jt.getPropertyChatStatus);case 20:return a.resolve({groupStatus:e.sent.toLowerCase(),chatting:s}),e.abrupt("return");case 23:return e.prev=23,e.next=26,ye(Yo,o);case 26:if(c=Zo(e.sent),u=c.chatStatus,p=c.chatState,i&&p===po)return he(At.setPropertyClientLimitExceeded(!(e.next=31)));e.next=31;break;case 31:a.resolve({groupStatus:u.toLowerCase(),chatting:p===po}),e.next=37;break;case 34:e.prev=34,e.t1=e.catch(23),a.reject({type:"connection",reason:"Request failed"});case 37:case"end":return e.stop()}},wi,null,[[23,34]])}function Ps(){return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,ye(u,Si);case 3:return e.next=5,ke(Jt.getPropertyChatState);case 5:if(e.sent===po){e.next=10;break}return e.next=10,he(At.setPropertyClientLimitExceeded(!0));case 10:e.next=0;break;case 12:case"end":return e.stop()}},ki)}function Cs(){var t,r;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ie([Ci.getActionName()],X.expanding());case 2:return t=e.sent,e.next=5,de("VISITOR_DATA_WATCHER");case 5:return e.next=8,de(t);case 8:return r=e.sent,e.next=11,ye(Lr,Jt.getPropertyPingSent);case 11:return e.next=13,ye(ts,r);case 13:e.next=5;break;case 15:case"end":return e.stop()}},Ii)}function As(t){var r;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload,e.next=3,he(At.setPropertyGroup(r.group));case 3:case"end":return e.stop()}},Ti)}function Os(){var n,t,r;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xe(Ps);case 2:return e.next=4,xe(Cs);case 4:return e.next=6,Ee(Hi.getActionName(),Is);case 6:return e.next=8,Ee(qi.getActionName(),us);case 8:return e.next=10,Ee(Mi.getActionName(),ss);case 10:return e.next=12,Ee(Ji.getActionName(),cs);case 12:return e.next=14,Ee(Di.getActionName(),ls);case 14:return e.next=16,Ee(Oi.getActionName(),os);case 16:return e.next=18,Ee(Ni.getActionName(),rs);case 18:return e.next=20,Ee(ji.getActionName(),as);case 20:return e.next=22,Ee(Ri.getActionName(),ns);case 22:return e.next=24,Ee(Li.getActionName(),is);case 24:return e.next=26,Ee(Ai.getActionName(),ps);case 26:return e.next=28,Ee(Gi.getActionName(),ds);case 28:return e.next=30,Ee($i.getActionName(),bs);case 30:return e.next=32,Ee(Bi.getActionName(),_s);case 32:return e.next=34,Ee(Vi.getActionName(),ws);case 34:return e.next=36,Ee(zi.getActionName(),ks);case 36:return e.next=38,Ee(Wi.getActionName(),Ts);case 38:return e.next=40,Ee(Yi.getActionName(),Ss);case 40:return e.next=42,Ee(Zi.getActionName(),As);case 42:return e.next=44,Ie([Pi.getActionName(),Ui.getActionName(),Fi.getActionName(),Ki.getActionName()],X.expanding());case 44:n=e.sent,t=ir.mark(function e(){var t,r;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,de(n);case 2:e.t0=(t=e.sent).type,e.next=e.t0===Pi.getActionName()?6:e.t0===Ui.getActionName()?9:e.t0===Fi.getActionName()?19:e.t0===Ki.getActionName()?22:25;break;case 6:return e.next=8,ye(es,t);case 8:return e.abrupt("break",26);case 9:return e.next=11,xe(ys,t);case 11:return r=e.sent,e.next=14,ge({success:_e(r),cancel:de(function(e){return e.type===yr.getActionName()&&e.payload.customId===t.payload.customId})});case 14:if(e.sent.cancel)return e.next=18,we(r);e.next=18;break;case 18:return e.abrupt("break",26);case 19:return e.next=21,ye(vs,t);case 21:return e.abrupt("break",26);case 22:return e.next=24,ye(Es,t);case 24:return e.abrupt("break",26);case 25:return e.abrupt("return",{v:void 0});case 26:case"end":return e.stop()}},e)});case 46:return e.delegateYield(t(),"t0",48);case 48:if("object"==typeof(r=e.t0))return e.abrupt("return",r.v);e.next=51;break;case 51:e.next=46;break;case 53:case"end":return e.stop()}},Ei)}var Ns=ir.mark(Rs);function Rs(t){var r,n,a,o,i,s,c,u,p,l,f,d,h,m,g;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.customId,n=t.text,a=t.answers,o=t.welcomeMessage,i=t.acceptedInvitation,c=void 0!==(s=t.fromManualInvitation)&&s,e.next=3,ke(Jt.getPropertyGroup);case 3:return u=e.sent,e.next=6,ye(Lr,Jt.getPropertyVisitorId);case 6:return p=e.sent,e.next=9,ke(er);case 9:if(e.t1=(l=e.sent).name,e.t1){e.next=15;break}return e.next=14,ye(Qi);case 14:e.t1=e.sent.client;case 15:if(e.t0=e.t1,e.t0){e.next=18;break}e.t0="Client";case 18:return f=e.t0,e.next=21,ke(Jt.getPropertyMobile);case 21:return d=e.sent,e.next=24,ye(Lr,Jt.getPropertyPingSent);case 24:return h={group:u,source_group:u,details:"",details_labels:"",from_manual_invitation:c,integration_params:"",random_id:r,trigger_unique_id:"",version:"Embedded",custom_variables:{},is_mobile:d,welcome_message:(o||"").replace(/%name%/g,f),return_secured_session_id:!0,visitor:{id:p,nick:f,email:l.email||""},script_version:{embedded_env:"production",embedded_version:"VisitorSDK-0.37.0-1"}},n&&(h.visitor_message=n,h.visitor_message_id=r),l.customProperties&&(h.custom_variables=Ze(String,l.customProperties)),a&&(h.pre_chat_survey=a),i&&(h.trigger_unique_id=i),e.next=31,he(At.setPropertyChatId(void 0));case 31:return e.next=33,ke(Jt.getPropertyLicense);case 33:return m=e.sent,$r.removeItem("securedToken"),$r.removeOldSecretTokenCookie(m),e.next=38,he(At.removePropertySecuredToken());case 38:return e.next=40,he(At.setPropertyServerIdsMap({}));case 40:return e.next=42,he(At.setPropertyVisitorCustomIdMap({}));case 42:return e.next=44,ye(Ua,"start_chat",h);case 44:if((g=e.sent).secured_session_id)return e.next=48,he(At.setPropertySecretId(g.secured_session_id));e.next=49;break;case 48:$r.setItem("secretId",g.secured_session_id);case 49:if(g.secured_token)return e.next=52,he(At.setPropertySecuredToken(g.secured_token));e.next=55;break;case 52:return e.next=54,he(At.setPropertyChatState(po,{source:c?"manual_invitation":"start_chat"}));case 54:$r.setItem("securedToken",g.secured_token);case 55:case"end":return e.stop()}},Ns)}var js=ir.mark(Fs),Ls=ir.mark(qs),Ms=ir.mark($s),Ds=ir.mark(Bs),Us=ir.mark(Vs),Gs=function(e,t,r,n){var a,o={visitor:{id:t,group:r}};return e&&(o.page={title:n.pageTitle,url:n.pageUrl}),e&&n.pageReferrer&&(o.page.referrer=n.pageReferrer),e&&n.email&&(o.visitor.email=n.email),e&&n.name&&(o.visitor.name=n.name),e&&n.customProperties&&(o.visitor.custom_variables=Object.keys(a=n.customProperties).map(function(e){return{name:e+"",value:a[e]+""}})),o};function Fs(t){var r,n,a,o,i,s,c,u,p,l,f;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.sendFullPing,e.next=3,ye(Lr,Jt.getPropertyVisitorId);case 3:return n=e.sent,e.next=6,ke(Jt.getPropertyLicense);case 6:return a=e.sent,e.next=9,ke(Jt.getPropertyGroup);case 9:return o=e.sent,e.next=12,ke(er);case 12:return i=e.sent,e.next=15,ke(Qt);case 15:return s=e.sent,e.next=18,ke(Jt.getPropertyRegion);case 18:return c=e.sent,u=Gs(r,n,o,i),e.next=22,ke(Jt.getPropertyChatBetweenGroups);case 22:return p=e.sent,e.next=25,ke(Jt.getPropertyRequestDistribution);case 25:return l=e.sent,e.prev=26,e.t0=ye,e.t1=ga,e.t2=a,e.t3=s,e.t4=c,e.t5=u,e.next=35,Te("external");case 35:return e.t6=e.sent,e.t7=p,e.t8=o,e.t9=l,e.t10={license:e.t2,environment:e.t3,region:e.t4,body:e.t5,external:e.t6,chatBetweenGroups:e.t7,group:e.t8,requestDistribution:e.t9},e.t11={retry:10},e.next=43,(0,e.t0)(e.t1,"ping",e.t10,e.t11);case 43:return f=e.sent,e.next=46,ke(Jt.getPropertyConnectionStatus);case 46:if("connected"!==e.sent)return e.next=50,he(At.setPropertyConnectionStatus("connected"));e.next=50;break;case 50:return e.abrupt("return",f);case 53:return e.prev=53,e.t12=e.catch(26),e.next=57,ke(Jt.getPropertyConnectionStatus);case 57:if("disconnected"!==e.sent)return e.next=61,he(At.setPropertyConnectionStatus("disconnected"));e.next=61;break;case 61:return e.abrupt("return",{error:!0});case 62:case"end":return e.stop()}},js,null,[[26,53]])}function qs(t){var r,n,a,o;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.automatic_greeting)return r=Zr(t.automatic_greeting),n=r.agent,a=r.invitation,e.next=4,he(jt(vt({},n,{fromInvitation:!0})));e.next=8;break;case 4:return e.next=6,he(zt(a));case 6:e.next=20;break;case 8:if(t.personal_greeting)return e.next=11,ye(Rs,{customId:Math.random()+"",welcomeMessage:t.personal_greeting.greeting_message.message,fromManualInvitation:!0});e.next=13;break;case 11:e.next=20;break;case 13:if(t.standard_greeting)return e.next=16,ye(Qi);e.next=20;break;case 16:return o=e.sent.welcome_to_chat,e.next=20,ye(Rs,{customId:Math.random()+"",welcomeMessage:o,fromManualInvitation:!0});case 20:case"end":return e.stop()}},Ls)}function $s(){var t,r,n,a;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ie(qt.getActionName(),X.expanding());case 2:return t=e.sent,e.next=5,he({type:"VISITOR_DATA_WATCHER"});case 5:return e.next=8,de(t);case 8:if((r=e.sent).payload.internal){e.next=26;break}return e.next=12,ye(Fs,{sendFullPing:!0});case 12:if((n=e.sent).error)return e.next=16,he(Mt({error:n.error,requestId:r.payload.requestId}));e.next=17;break;case 16:return e.abrupt("return",e.sent);case 17:return e.next=19,ye(qs,n);case 19:return e.next=21,ke(er);case 21:return a=e.sent,e.next=24,he(Lt({visitorData:a,requestId:r.payload.requestId}));case 24:e.next=34;break;case 26:return e.t0=he,e.next=29,ke(er);case 29:return e.t1=e.sent,e.t2={visitorData:e.t1},e.t3={type:"EMIT_VISITOR_DATA",payload:e.t2},e.next=34,(0,e.t0)(e.t3);case 34:e.next=5;break;case 36:case"end":return e.stop()}},Ms)}function Bs(){var t,r,n,a;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=3,r=!0,e.next=4,ye(Lr,Jt.getPropertyRequestDistribution);case 4:return e.next=7,ye(Fs,{sendFullPing:r});case 7:if(a=r,r=!!(n=e.sent).next_ping_send_full_details,0===n.next_ping_delay)return e.next=13,ye(co);e.next=16;break;case 13:return e.next=15,he(At.setPropertyClientLimitExceeded(!0));case 15:return e.abrupt("return");case 16:return t=!a&&r?0:n.next_ping_delay||3,e.next=19,ye(qs,n);case 19:return e.next=21,he(At.setPropertyPingSent(!0));case 21:return e.next=23,ye(u,1e3*t);case 23:e.next=4;break;case 25:case"end":return e.stop()}},Ds)}function Vs(){return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xe(Bs);case 2:return e.next=4,xe($s);case 4:case"end":return e.stop()}},Us)}var zs=Gr?function(n){var e=tt(function(e){var t,r=(t=e,t.replace(xt,"")).split("=");return decodeURIComponent(r[0])===n},document.cookie.split(";"));return e?decodeURIComponent(e.split("=")[1]):null}:function(){return null},Hs=ir.mark(Ws);function Ws(){var t,r,n,a,o,i,s,c;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye(Lr,Jt.getPropertyRequestDistribution);case 2:return e.next=5,ke(Jt.getPropertyLicense);case 5:return t=e.sent,e.prev=6,e.next=9,ye(Yo);case 9:return r=e.sent,e.next=12,ke(Jt.getPropertyChatStatus);case 12:return n=e.sent,e.next=15,ke(Jt.getPropertyChatState);case 15:return a=e.sent,o=Zo(r),i=o.chatStatus,s=o.chatState,e.next=19,ke(Jt.getPropertyConnectionStatus);case 19:if("connected"!==e.sent)return e.next=23,he(At.setPropertyConnectionStatus("connected"));e.next=23;break;case 23:if(n!==i)return e.next=26,he(At.setPropertyChatStatus(i));e.next=26;break;case 26:if(a!==s&&s===po)return c=$r.getItem("securedToken")||zs("secret_token_"+t),e.next=30,he(At.setPropertySecuredToken(c));e.next=32;break;case 30:return e.next=32,he(At.setPropertyChatState(s,{source:"other_tab"}));case 32:e.next=42;break;case 34:return e.prev=34,e.t0=e.catch(6),e.next=38,ke(Jt.getPropertyConnectionStatus);case 38:if("disconnected"!==e.sent)return e.next=42,he(At.setPropertyConnectionStatus("disconnected"));e.next=42;break;case 42:return e.next=44,ye(u,3e3);case 44:e.next=2;break;case 46:case"end":return e.stop()}},Hs,null,[[6,34]])}var Ks="chat_started",Ys="new_message",Zs="chat_ended",Js="agent_changed",Qs="status_changed",Xs="connection_status_changed",ec="new_file",tc="visitor_queued",rc="typing_indicator",nc="visitor_data",ac="chat_rated",oc="new_invitation",ic="ready",sc="message_seen",cc="protocol_upgraded",uc="integration_data",pc=ir.mark(yc),lc=ir.mark(_c),fc=ir.mark(wc),dc=ir.mark(kc),hc=ir.mark(Ec),mc=ir.mark(Pc),gc=ir.mark(Oc),vc=ir.mark(Lc);function yc(t,r){var n,a,o,i,s;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.payload,(n=t.emitter).emit("__start_chat_request_succeeded"),e.next=5,ye(Lr,Jt.getPropertyChatId);case 5:if(n.emit(Ks,{chatId:o=e.sent}),a.welcomeMessage)return e.next=10,ke(Jt.getPropertyLastAgentId);e.next=18;break;case 10:return i=e.sent,e.next=13,ke(Jt.getPropertyServerIdsMap);case 13:return s=e.sent,e.next=16,he(At.setPropertyServerIdsMap(vt({},s,{welcome_message:{serverId:"welcome_message",authorId:i}})));case 16:return e.next=18,he(Nt({id:"welcome_message",timestamp:Date.now(),authorType:"agent",authorId:i,text:a.welcomeMessage,chatId:o,customId:"welcome_message"}));case 18:if(a.visitorMessage)return e.next=21,he(Nt(a.visitorMessage));e.next=21;break;case 21:return e.next=23,de(Rt.getActionName());case 23:return n.emit(Zs,{reason:e.sent.payload.reason}),e.next=28,he(At.setPropertyLastMessageId(null));case 28:case"end":return e.stop()}},pc)}function xc(e,t){e.emitter.emit(Qs,{status:t.payload.data.toLowerCase()})}function bc(e,t){e.emitter.emit(Xs,{status:t.payload.data.toLowerCase()})}function _c(t,r){var n,a,o,i,s;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.emitter,a=r.payload,e.next=4,ye(Lr,Jt.getPropertyChatId);case 4:return o=e.sent,e.next=7,ke(Jt.getPropertyVisitorId);case 7:i=e.sent,s={id:a.id,timestamp:a.timestamp,authorId:"visitor"===a.authorType?i:a.authorId,text:a.text,chatId:o,json:a.json},void 0!==a.isMobile&&(s.isMobile=a.isMobile),void 0!==a.customId&&(s.customId=a.customId),n.emit(Ys,s);case 12:case"end":return e.stop()}},lc)}function wc(t,r){var n,a,o,i;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.emitter,a=r.payload,e.next=4,ke(Jt.getPropertyVisitorId);case 4:o=e.sent,i={id:a.id,timestamp:a.timestamp,authorId:"visitor"===a.authorType?o:a.authorId,url:a.url,contentType:a.contentType,size:a.size},a.thumbnail&&(i.thumbnail=a.thumbnail),n.emit(ec,i);case 8:case"end":return e.stop()}},fc)}function kc(t,r){var n,a,o;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.emitter,a=r.payload,ke(Jt.getPropertyLastAgentId)===a.id)return e.abrupt("return");e.next=5;break;case 5:return e.next=7,he(At.setPropertyLastAgentId(a.id));case 7:o={name:a.name,id:a.id},a.avatarUrl&&(o.avatarUrl=a.avatarUrl),a.jobTitle&&(o.jobTitle=a.jobTitle),a.fromInvitation&&(o.fromInvitation=a.fromInvitation),a.trigger&&(o.trigger=a.trigger),n.emit(Js,o);case 13:case"end":return e.stop()}},dc)}function Ic(e,t){var r=t.payload;e.emitter.emit(tc,{numberInQueue:r.numberInQueue,waitingTime:r.waitingTime})}function Tc(e,t){var r=t.payload;e.emitter.emit(rc,{authorId:r.authorId,isTyping:r.isTyping})}function Ec(t){var r,n,a,o;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.emitter,e.next=3,ye(Lr,Jt.getPropertyVisitorId);case 3:return n=e.sent,e.next=6,ke(er);case 6:o=(a=e.sent).name?{id:n,name:a.name}:{id:n},Promise.resolve().then(function(){r.emit(nc,o)});case 9:case"end":return e.stop()}},hc)}function Sc(e,t){e.emitter.emit(ac,{rate:t.payload.rate,comment:t.payload.comment})}function Pc(t,r){return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.emitter.emit(oc,r.payload),e.next=4,de(function(e){return e.type===Er.getActionName()&&e.payload.id===r.payload.id});case 4:return e.next=6,he(At.setPropertyWelcomeMessage(r.payload.text));case 6:case"end":return e.stop()}},mc)}function Cc(e){e.emitter.emit(ic)}function Ac(e,t){e.emitter.emit(sc,t.payload)}function Oc(t,r,n){return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ye(t[n.type],{emitter:r},n);case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}},gc,null,[[0,5]])}function Nc(e){e.emitter.emit(cc)}function Rc(e,t){e.emitter.emit(uc,t.payload)}function jc(e,t){e.emitter.emit(nc,Je(t.payload.visitorData))}function Lc(t){var r,n,a;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.emitter,e.next=3,xe(Ec,{emitter:n});case 3:return(r={})[Ot.getActionName()]=yc,r[At.setPropertyChatStatus.getActionName()]=xc,r[At.setPropertyConnectionStatus.getActionName()]=bc,r[Nt.getActionName()]=_c,r[Dt.getActionName()]=wc,r[jt.getActionName()]=kc,r[Ut.getActionName()]=Ic,r[Gt.getActionName()]=Tc,r[Ft.getActionName()]=Sc,r[zt.getActionName()]=Pc,r[At.setPropertyHistoryLoaded.getActionName()]=Cc,r[Ht.getActionName()]=Ac,r[Wt.getActionName()]=Nc,r[Kt.getActionName()]=Rc,r.EMIT_VISITOR_DATA=jc,a=r,e.next=6,Ee(Object.keys(a),Oc,a,n);case 6:case"end":return e.stop()}},vc)}var Mc=It("INCOMING_MESSAGE",function(e){return{name:e.name,message:e.message,trigger:e.trigger}}),Dc=1800,Uc=ir.mark(Gc);function Gc(t){var r,n,a,o,i;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t={}),e.next=3,ye(Lr,Jt.getPropertyVisitorId);case 3:return r=e.sent,e.next=6,ke(Jt.getPropertyGroup);case 6:return n=e.sent,e.next=9,ke(Jt.getPropertyLastMessageId);case 9:return a=e.sent,o=t.sneakPeek,i={random_id:Math.random()+"",visitor:{id:r,group:n}},a&&(i.last_unique_id=a),"string"==typeof o&&(i.sneak_peek=o),e.next=16,ye(Ua,"get_pending_messages",i);case 16:return e.abrupt("return",e.sent);case 17:case"end":return e.stop()}},Uc)}var Fc=ir.mark(Hc),qc=ir.mark(Zc),$c=ir.mark(Jc),Bc=ir.mark(Qc),Vc=ir.mark(Xc),zc="";function Hc(){var t;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ke(Jt.getPropertyLicense);case 2:return t=e.sent,e.next=5,he(At.setPropertyChatState(lo));case 5:return e.next=7,he(At.removePropertySecuredToken());case 7:return e.next=9,he(Rt());case 9:return $r.removeItem("securedToken"),$r.removeOldSecretTokenCookie(t),e.next=13,he(At.setPropertyServerIdsMap({}));case 13:return e.next=15,he(At.setPropertyVisitorCustomIdMap({}));case 15:case"end":return e.stop()}},Fc)}var Wc=function(e){return st("message.data",e)&&(e.message.data=pt(Qe,e.message.data)),st("message.name",e)&&(e.message.name=Qe(e.message.name)),vt({timestamp:e.timestamp,uniqueId:e.unique_id},e.message)},Kc=function(e){return Math.max.apply(Math,[0].concat(e.map(function(e){return e.unique_id})))},Yc=function(e,r){return e.messages.map(function(e){if(e.message_iwcs){var t=Aa(e.message_iwcs,r);return!!t&&{timestamp:e.timestamp,unique_id:e.unique_id,message:t}}return e}).filter(Boolean).map(Wc)};function Zc(){var t,r,n;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye(Lr,Jt.getPropertyConfigLoaded);case 2:return e.next=4,ke(Jt.getPropertySecuredToken);case 4:if(e.sent)return e.prev=6,e.next=9,ye(Gc);e.next=34;break;case 9:if((t=e.sent).messages)return r=Yc(t,{trigger:"init"}),e.next=14,me(r.map(function(e){return he(Mc({name:e.name,message:e}))}));e.next=20;break;case 14:if(n=Kc(t.messages))return e.next=18,he(At.setPropertyLastMessageId(n));e.next=18;break;case 18:e.next=22;break;case 20:return e.next=22,ye(Hc);case 22:e.next=32;break;case 24:return e.prev=24,e.t0=e.catch(6),e.next=28,ke(Jt.getPropertyConnectionStatus);case 28:if("disconnected"!==e.sent)return e.next=32,he(At.setPropertyConnectionStatus("disconnected"));e.next=32;break;case 32:e.next=36;break;case 34:return e.next=36,he(At.setPropertyChatState(lo));case 36:return e.next=38,he(At.setPropertyHistoryLoaded(!0));case 38:case"end":return e.stop()}},qc,null,[[6,24]])}function Jc(){var t,r,n,a,o,i,s;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t={};case 1:return e.next=4,ke(Jt.getPropertySecuredToken);case 4:return r=e.sent,e.next=7,ke(Jt.getPropertyChatState);case 7:return n=e.sent,e.next=10,ke(Jt.getPropertySneakPeek);case 10:if(a=e.sent,r&&n===po)return e.prev=12,e.next=15,ye(Gc,{sneakPeek:zc!==a?a:null});e.next=44;break;case 15:return o=e.sent,e.next=18,ke(Jt.getPropertyConnectionStatus);case 18:if("connected"!==e.sent)return e.next=22,he(At.setPropertyConnectionStatus("connected"));e.next=22;break;case 22:if(o.messages){e.next=27;break}return e.next=25,ye(Hc);case 25:e.next=34;break;case 27:if(i=Yc(o,{trigger:t.chatHasJustStarted?t.chatHasJustStarted.payload.meta.source:null}),s=Kc(o.messages))return e.next=32,he(At.setPropertyLastMessageId(s));e.next=32;break;case 32:return e.next=34,me(i.map(function(e){return he(Mc({name:e.name,message:e}))}));case 34:e.next=44;break;case 36:return e.prev=36,e.t0=e.catch(12),e.next=40,ke(Jt.getPropertyConnectionStatus);case 40:if("disconnected"!==e.sent)return e.next=44,he(At.setPropertyConnectionStatus("disconnected"));e.next=44;break;case 44:return zc=a,e.next=47,ge({chatHasJustStarted:de(function(e){return e.type===At.setPropertyChatState.getActionName()&&e.payload.data===po}),intervalElapsed:ye(u,Dc),sendFileAttempt:de(vr.getActionName()),sendMessegeResponseReceived:de("PRIVATE_SEND_MESSAGE")});case 47:t=e.sent,e.next=1;break;case 50:case"end":return e.stop()}},$c,null,[[12,36]])}function Qc(){return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye(Lr,Jt.getPropertyChatState);case 2:return e.next=4,ye(Jc);case 4:case"end":return e.stop()}},Bc)}function Xc(){return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye(Zc);case 2:return e.next=4,be(Qc);case 4:case"end":return e.stop()}},Vc)}var eu="agentMessageSeen",tu="sendMessage",ru="startChat",nu="chatAttachment",au="sendRatingComment",ou="visitorMessageSeen",iu=ir.mark(uu),su=ir.mark(pu),cu=ir.mark(lu);function uu(t,r){var n,a;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ke(Jt.getPropertyVisitorCustomIdMap);case 2:return a=e.sent,e.next=5,he(At.setPropertyVisitorCustomIdMap(vt({},a,((n={})[t]=r,n))));case 5:case"end":return e.stop()}},iu)}function pu(t){var r,n,a,o,i,s,c,u,p,l,f,d;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(r=t.payload.message).timestamp*=1e3,e.t0=r.name,e.next=e.t0===ru?6:e.t0===tu?26:e.t0===Pa.RATE_CHAT?31:e.t0===au?34:e.t0===nu?37:e.t0===Pa.NEW_AGENT_MESSAGE?45:e.t0===Pa.AGENTS_OFFLINE?53:e.t0===Pa.CHAT_ENDED?53:e.t0===Pa.NEW_AGENT?69:e.t0===Pa.VISITOR_QUEUED?78:e.t0===Pa.TYPING_INDICATOR?81:e.t0===ou?84:e.t0===Pa.INTEGRATION_DATA?96:e.t0===eu?99:111;break;case 6:return e.next=8,ke(Jt.getPropertySecuredToken);case 8:return e.t1=e.sent,e.t2=r.data.welcomeMessage,n={securedToken:e.t1,welcomeMessage:e.t2},a=st("data.visitor.nick",r),e.next=14,ke(er);case 14:if(o=e.sent,a&&a!==o.name)return e.next=18,he(qt({visitorData:vt({},o,{name:a}),internal:!0}));e.next=18;break;case 18:return r.data.visitorMessage&&(n.visitorMessage={id:r.uniqueId,timestamp:r.timestamp,authorType:"visitor",text:r.data.visitorMessage,customId:r.data.randomId}),e.next=21,he(At.setPropertyChatId(void 0));case 21:return e.next=23,he(Ot(n));case 23:return e.next=25,ye(uu,r.data.randomId,r.uniqueId);case 25:return e.abrupt("break",112);case 26:return e.next=28,ye(uu,r.data.randomId,r.uniqueId);case 28:return e.next=30,he(Nt({id:r.uniqueId,timestamp:r.timestamp,authorType:"visitor",text:r.data.message,customId:r.data.randomId}));case 30:return e.abrupt("break",112);case 31:return e.next=33,he(Ft({id:r.uniqueId,timestamp:r.timestamp,rate:r.data.rate,comment:r.data.comment}));case 33:return e.abrupt("break",112);case 34:return e.next=36,he(Ft({id:r.uniqueId,timestamp:r.timestamp,comment:r.data.comment}));case 36:return e.abrupt("break",112);case 37:return e.next=39,ke(Jt.getPropertyServerIdsMap);case 39:return s=e.sent,e.next=42,he(At.setPropertyServerIdsMap(vt({},s,((i={})[r.uniqueId]={serverId:r.data.attachmentToken,authorId:r.data.author.login},i))));case 42:return e.next=44,he(Dt({id:r.uniqueId,timestamp:r.timestamp,authorId:r.data.author.login||"visitor",authorType:r.data.author.type,url:r.data.files[0].url,size:r.data.files[0].size,contentType:r.data.files[0]["content-type"],attachmentToken:r.data.attachmentToken,thumbnail:r.data.files[0].thumbs}));case 44:return e.abrupt("break",112);case 45:return e.next=47,ke(Jt.getPropertyServerIdsMap);case 47:return u=e.sent,e.next=50,he(At.setPropertyServerIdsMap(vt({},u,((c={})[r.uniqueId]={serverId:r.data.id,authorId:r.data.authorId},c))));case 50:return e.next=52,he(Nt({id:r.uniqueId,timestamp:r.timestamp,authorType:"agent",text:r.data.message,isMobile:r.data.isMobile,authorId:r.data.authorId,serverId:r.data.id,json:r.data.json}));case 52:return e.abrupt("break",112);case 53:return e.next=55,he(Rt(r.data));case 55:return e.next=57,he(At.setPropertyChatState(lo));case 57:return e.next=59,ke(Jt.getPropertyHistoryLoaded);case 59:return p=e.sent,e.next=62,ke(Jt.getPropertyLicense);case 62:if(l=e.sent,$r.removeItem("securedToken"),$r.removeOldSecretTokenCookie(l),p){e.next=68;break}return e.next=68,he(At.removePropertySecuredToken());case 68:return e.abrupt("break",112);case 69:return e.next=71,he(jt({id:r.data.id,name:r.data.name,jobTitle:r.data.jobTitle,avatarUrl:Yr(r.data.avatarUrl),trigger:r.data.trigger}));case 71:return e.next=73,ke(Jt.getPropertyChatId);case 73:if(e.sent){e.next=77;break}return e.next=77,he(At.setPropertyChatId(r.data.chatId));case 77:return e.abrupt("break",112);case 78:return e.next=80,he(Ut({numberInQueue:r.data.numberInQueue,waitingTime:r.data.waitingTime}));case 80:return e.abrupt("break",112);case 81:return e.next=83,he(Gt({authorId:r.data.authorId,isTyping:r.data.isTyping}));case 83:return e.abrupt("break",112);case 84:return e.t3=he,e.t4=Yt,e.next=88,ke(Jt.getPropertyVisitorCustomIdMap);case 88:return e.t5=r.data.id,e.t6=e.sent[e.t5],e.t7=r.data.id,e.t8={id:e.t6,customId:e.t7,type:"visitor"},e.t9=e.t4.messageSeen.call(e.t4,e.t8),e.next=95,(0,e.t3)(e.t9);case 95:return e.abrupt("break",112);case 96:return e.next=98,he(Kt({id:r.uniqueId+"",timestamp:r.timestamp,integrationName:r.data.integrationName,data:r.data.data}));case 98:return e.abrupt("break",112);case 99:return e.next=101,ke(Jt.getPropertyServerIdsMap);case 101:if(d=null,f=e.sent){e.next=105;break}return e.abrupt("break",112);case 105:if(at(function(e,t){e.serverId===r.data.message.id&&(d=t)},f),d){e.next=108;break}return e.abrupt("break",112);case 108:return e.next=110,he(Ht({id:d,customId:r.data.message.id,type:"agent"}));case 110:return e.abrupt("break",112);case 111:return e.abrupt("return");case 112:case"end":return e.stop()}},su)}function lu(){var t,r;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ie(Mc.getActionName(),X.expanding());case 2:t=e.sent;case 3:return e.next=6,de(t);case 6:return r=e.sent,e.next=9,ye(pu,r);case 9:e.next=3;break;case 11:case"end":return e.stop()}},cu)}var fu=ir.mark(yu),du=ir.mark(xu),hu=ir.mark(bu),mu=[sr,br,Pr,wr,Ot].map(function(e){return e.getActionName()}),gu=function(e){var t=e.payload;return e.type===At.setPropertyClientLimitExceeded.getActionName()&&!0===t.data},vu=function(e){var t=e.payload;return e.type===At.setPropertyClientLimitExceeded.getActionName()&&!1===t.data};function yu(){var t,r,n;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Mr(xe(Xc));case 2:t=e.sent;case 3:return e.next=6,ge([de(mu),de(vu)]);case 6:return e.next=8,Mr(xe(Ws));case 8:return r=e.sent,e.next=11,Mr(xe(Vs));case 11:return n=e.sent,e.next=14,ge([de(hr.getActionName()),de(gu)]);case 14:return e.next=16,he(At.setPropertyPingSent(void 0));case 16:return e.next=18,we(r,t,n);case 18:e.next=3;break;case 20:case"end":return e.stop()}},fu)}function xu(){var t;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,de(At.setPropertyGroup);case 3:return t=e.sent.payload.data,e.next=7,ke(Jt.getPropertyLicense);case 7:$r.setPrefix("_livechat_"+e.sent+"_"+t),e.next=0;break;case 11:case"end":return e.stop()}},du)}function bu(t){var r,n;return ir.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.emitter,n=t.serverConfig,e.next=3,ke(Jt.getPropertyChatBetweenGroups);case 3:if(!1===e.sent)return e.next=7,Mr(xe(xu));e.next=7;break;case 7:return e.next=9,Mr(xe(Os));case 9:return e.next=11,Mr(xe(Lc,{emitter:r}));case 11:return e.next=13,Mr(xe(lu));case 13:return e.next=15,Mr(xe(yu));case 15:return e.next=17,ye(uo,n);case 17:case"end":return e.stop()}},hu)}var _u=function(n){return n=n||Object.create(null),{on:function(e,t){(n[e]||(n[e]=[])).push(t)},off:function(e,t){n[e]&&n[e].splice(n[e].indexOf(t)>>>0,1)},emit:function(t,r){(n[t]||[]).slice().map(function(e){e(r)}),(n["*"]||[]).slice().map(function(e){e(t,r)})}}},wu="LISTENER_IDENTITY",ku={};e.init=function(e,t){var r,n=void 0===e?{}:e,a=n.license,o=n.group,i=n.environment,s=void 0===i?aa:i,c=n.page,u=void 0===c?{}:c,p=n.visitor,l=void 0===p?{}:p,f=n.region,d=n.external,h=void 0===d||d,m=n.mobile,g=void 0!==m&&m;if(!a)throw Error("Missing license parameter");if(s!==aa&&s!==ia&&s!==oa)throw Error("Wrong environment parameter");var v,y,x=vt({},y=_u(v=Object.create(null)),{off:function(e,t){e?y.off(e,t):Object.keys(v).forEach(function(e){delete v[e]})},once:function(n,a){y.on(n,function e(t,r){y.off(n,e),a(t,r)})}}),b=x.emit,_=[];x.emit=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];_.push(t)},setTimeout(function(){x.emit=b,_.forEach(function(e){x.emit.apply(x,e)}),_=null},0);var w=Math.random()+"",k=function(e){if(void 0===e&&(e={}),e.__lc&&!1===e.__lc.chat_between_groups)return!1;var t=st("location.href",Gr&&document),r=t&&Hr(t);return!(r&&"1"===r.unique_groups||"1"===r.unique_group)}(t);$r.setPrefix(k?"_livechat_"+a:"_livechat_"+a+"_"+o);var I=((r={environment:s})[Ct.LICENSE]=a,r[Ct.GROUP]=o,r[Ct.SESSION_ID]=w,r[Ct.MOBILE]=g,r.visitorData={email:l.email||null,name:l.name||null,pageUrl:u.url||ct("unknown","location.href",Gr&&document),pageTitle:u.title||ct("unknown","0.innerHTML",Gr&&document.getElementsByTagName("title")||{}),pageReferrer:u.referrer,customProperties:l.customProperties&&!ut(l.customProperties)?l.customProperties:null},r[Ct.SECURED_TOKEN]=$r.getItem("securedToken")||zs("secret_token_"+a),r[Ct.SECRET_ID]=$r.getItem("secretId"),r[Ct.CHAT_BETWEEN_GROUPS]=k,r);f&&(I[Ct.REGION]=f);var T,E,S,P=(T=I,E=nr({context:{external:h}}),(S=Ve(tr,T,nt(ze(E)))).runSaga=E.run,S),C=$r.getItem("visitorId");C&&P.dispatch(At.setPropertyVisitorId(C));var A,O,N,R,j,L,M,D,U,G,F,q,$,B,V,z,H,W,K,Y,Z,J,Q,X,ee,te=P.runSaga(bu,{emitter:x,serverConfig:t});return{sendMessage:(ee=P,function(e){var t=void 0===e?{}:e,r=t.text,n=t.customId,a=t.json,o=re();return r&&n?ee.dispatch(sr({customId:n,text:r,json:a,promise:o})):o.reject({type:"missing argument",reason:"Missing text or customId parameter"}),o.promise}),setSneakPeek:(X=P,function(e){var t=e.text,r=re();return X.dispatch(lr({text:t,promise:r})),r.promise}),setVisitorData:(Q=P,function(e){var t=void 0===e?{}:e,r=t.name,n=t.email,a=t.customProperties,o=t.pageUrl,i=t.pageTitle,s=t.update,c=re();return r||n||a||o||i?Q.dispatch(cr({name:r,email:n,customProperties:a,pageUrl:o,pageTitle:i,update:s,promise:c})):c.reject({type:"missing argument",reason:"Missing name, email, url or customProperties"}),c.promise}),getVisitorData:(J=P,function(){var e=re();return J.dispatch(ur({promise:e})),e.promise}),rateChat:(Z=P,function(e){var t=void 0===e?{}:e,r=t.rate,n=t.comment,a=re();return r||n?r&&"good"!==r&&"none"!==r&&"bad"!==r?a.reject({type:"wrong argument",reason:'Rate argument should be equal "good", "bad" or "none"'}):Z.dispatch(pr({rate:r,comment:n,promise:a})):a.reject({type:"missing argument",reason:"Missing rate parameter"}),a.promise}),forwardChatTranscript:(Y=P,function(e){var t=(void 0===e?{}:e).email,r=re();return t?Y.dispatch(fr({email:t,promise:r})):r.reject({type:"missing argument",reason:"Missing email parameter"}),r.promise}),closeChat:(K=P,function(){var e=re();return K.dispatch(dr({promise:e})),e.promise}),disconnect:(W=P,function(){var e=re();return W.dispatch(hr({promise:e})),e.promise}),getTicketForm:(H=P,function(e){var t=(void 0===e?{}:e).group,r=re();return H.dispatch(mr({promise:r,group:t})),r.promise}),getTranslations:(z=P,function(){var e=re();return z.dispatch(_r({promise:e})),e.promise}),sendTicketForm:(V=P,function(e){void 0===e&&(e={});var t=re();return V.dispatch(gr({answers:e,promise:t})),t.promise}),sendFile:(B=P,function(e){var t=void 0===e?{}:e,r=t.file,n=t.onProgress,a=Math.random()+"",o=re();return r?10485760<r.size?(o.reject({type:"wrong argument",reason:"Cannot upload a file over 10MB"}),o.promise):(B.dispatch(vr({file:r,customId:a,promise:o,onProgress:n})),{then:function(e,t){return o.promise.then(e,t)},catch:function(e){return o.promise.catch(e)},cancel:function(){B.dispatch(yr({customId:a}))}}):(o.reject({type:"missing argument",reason:"Missing file"}),o.promise)}),on:x.on,off:x.off,destroy:(q=te,$=x,function(){$.off("*"),q.cancel()}),getPrechatForm:(F=P,function(){var e=re();return F.dispatch(xr({promise:e})),e.promise}),sendPrechatForm:(G=P,function(e){void 0===e&&(e={});var t=re();return G.dispatch(br({promise:t,answers:e})),t.promise}),getPredictedAgent:(U=P,function(){var e=re();return U.dispatch(wr({promise:e})),e.promise}),getPostChatForm:(D=P,function(){var e=re();return D.dispatch(kr({promise:e})),e.promise}),sendPostChatForm:(M=P,function(e){void 0===e&&(e={});var t=re();return M.dispatch(Ir({promise:t,answers:e})),t.promise}),getConfig:(L=P,function(){var e=re();return L.dispatch(Tr({promise:e})),e.promise}),acceptInvitation:function r(n){return function(e){var t=re();return n.dispatch(Er({id:e,promise:t})),r.promise}}(P),markMessageAsSeen:(j=P,function(e){var t=re();return j.dispatch(Sr({promise:t,messageId:e})),t.promise}),startChat:(R=P,function(){var e=re();return R.dispatch(Pr({promise:e})),e.promise}),checkGroupStatus:(N=P,function(e){var t=void 0!==e?parseInt(e,10):void 0,r=re();return N.dispatch(Cr({promise:r,group:t})),r.promise}),setVisitorGroup:(O=P,function(e){O.dispatch(Ar({group:parseInt(e,10)}))}),getQueueForm:(A=P,function(){var e=re();return A.dispatch(Or({promise:e})),e.promise})}},e.debug=function(e){console.warn("You probably do not want to use debug(visitorSDK) in your production environment.");var r=e.on,n=e.off,t=function(e,s){void 0===s&&(s="");var n=Object.keys(e);return n.map(function(o){var i=e[o];return function(){for(var e,t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];(e=console).info.apply(e,[s+"."+o+"() ===>"].concat(r));var a=i.apply(void 0,r);return a&&"function"==typeof a.then&&a.then(function(e){console.info(s+"."+o+"() <===",e)}).catch(function(e){console.error(s+"."+o+"() <===",e)}),a}}).reduce(function(e,t,r){return e[n[r]]=t,e},{})}(yt(e,["on","off"]));return Object.freeze(vt({},t,{off:function(e,t){console.info('.off("'+e+'", '+(t.name||"anonymous")+")");var r=t;void 0!==t[wu]&&(r=ku[t[wu][e]]),n(e,r)},on:function(e,t){r(e,function(t,r,n){if(void 0===n[wu]&&Object.defineProperty(n,wu,{value:{}}),n[wu][r])return ku[n[wu][r]];var e=function(e){console.info("."+t+'("'+r+'") <===',e),n(e)},a=it(ku);return ku[n[wu][r]=a]=e}("on",e,t))}}))},e.parseServerConfig=Xa,e.sendTicketToHelpDeskRequest=Po,e.getHelpDeskForRequestBody=Co,e.createSendTicketHelpdeskResponse=Ao,e.createSendTicketFormResponse=To,e.getTicketFormRequestBody=Io,e.translateForm=Qn,e.addTicketFormValidationRules=Xn,e.sendPostToAPI=da,Object.defineProperty(e,"__esModule",{value:!0})});
